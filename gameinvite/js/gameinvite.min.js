var gamingPlatform;!function(a){var b;!function(a){function b(){return window.performance?window.performance.now():(new Date).getTime()}function c(a,c,d){var e=b()-o,f=Math.round(e)/1e3,g=["",f," seconds:"].concat(a);return d.apply(console,g),{millisecondsFromStart:e,args:a,logLevel:c}}function d(a,b,d){n.length>100&&n.shift(),n.push(c(a,b,d))}function e(){return n.concat(m)}function f(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];m.push(c(a,l.ALWAYS,console.log))}function g(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.INFO,console.log)}function h(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.DEBUG,console.debug)}function i(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.WARN,console.warn)}function j(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.ERROR,console.error)}function k(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.LOG,console.log)}var l=function(){function a(){}return a.ALWAYS="ALWAYS",a.LOG="LOG",a.INFO="INFO",a.DEBUG="DEBUG",a.WARN="WARN",a.ERROR="ERROR",a}(),m=[],n=[],o=b();a.getCurrentTime=b,a.getLogs=e,a.alwaysLog=f,a.info=g,a.debug=h,a.warn=i,a.error=j,a.log=k}(b=a.log||(a.log={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){function b(){function b(b,d,g){g||(g=c);var h=null;if(f&&f[b]){var i=f[b];h=i[g],h||(h=i.en)}else h=e[b];return h||(h="["+b+"]",a.log.error("Couldn't find translationId="+b+" in language="+g)),a.$interpolate(h)(d||{})}var c,d,e=null,f=null;return d=b,d.getLanguage=function(){return c},d.setTranslations=function(a){f=a},d.setLanguage=function(a,b){c=a,e=b},d}a.translate=b(),a.defaultTranslateInterpolateParams={},angular.module("translate",[]).filter("translate",["$parse",function(b){var c=function(c,d){return angular.isObject(d)||(d=b(d)(this)),d||(d=a.defaultTranslateInterpolateParams),a.translate(c,d)};return c.$stateful=!0,c}])}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){function b(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];a.log.info("Sending Google Analytics: ",b,c),k.push([l+"."+b].concat(c))}function c(a,c){b("set",a,c)}function d(a,c,d){b("send","timing",{timingCategory:a,timingVar:c,timingValue:d})}function e(c,d){setTimeout(function(){b("send","event",c,d,{dimension1:a.gamesService.getGameId()})},0)}function f(b,c){if(a.log.info("Loading script ",c," into script element with id=",b),document.getElementById(b))return void a.log.error("Already loaded src=",c);var d=document.createElement("script");d.src=c,d.id=b,d.onload=function(){a.log.info("Loaded script ",c)},d.async=1,d.crossorigin="anonymous";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(d,e)}function g(b,c){return function(){try{return c.apply(this,arguments)}catch(d){throw a.log.error("Got an exception when calling ",b," with arguments ",arguments," exception=",d,d.stack),d}}}function h(b,c){var d=function(){return a.log.log("Api call for method=",b," with arguments=",arguments," this=",this),e("api",b),c.apply(this,arguments),!0};return d}function i(){return-1!==location.toString().indexOf("gameDeveloper")}function j(){try{return angular.module("ngRoute"),!0}catch(a){return!1}}var k,l="gamingPlatformTracker";a.setAnalyticsField=c,a.sendAnalyticsTiming=d,a.sendAnalyticsEvent=e,a.createScriptWithCrossorigin=f,function(){var a=window,c=a.GoogleAnalyticsObject||"gamingPlatformGoogleAnalytics";a.GoogleAnalyticsObject=c,a[c]=a[c]||function(){a[c].q.push(arguments)};var d=a[c];d.q=d.q||[],k=d.q,d.l=d.l||1*(new Date).getTime(),d("create","UA-56887721-1","auto",l),b("require","displayfeatures"),b("send","pageview")}(),a.logAndRethrow=g,a.wrapWithLogApi=h,a.isGameDeveloperSite=i,angular.module("myApp",["translate"].concat(j()?["ngRoute"]:[])).config(["$provide",function(b){i()||(b.decorator("$parse",["$delegate",function(b){return function(c,d,e){var f=b(c,d,e),h=g(["$parse-delegate: ",c],function(){var b=f.apply(this,arguments);return void 0===b&&"string"==typeof c&&c&&-1===c.indexOf("main.model().")&&a.log.error("You probably misspelled something in expression '",c,"', because it returned undefined in $parse!"),b});for(var i in f)h[i]=f[i];return h}}]),b.decorator("$interpolate",["$delegate",function(b){function c(b,c){return g(["$interpolate-interpolationFnWrap:",c],function(){var d=b.apply(this,arguments);if(!d){var e=c[0];e&&(e=e.trim()),e&&a.log.error("You probably misspelled something in expression '",e,"', because it returned something falsy (",d,") in $interpolate!")}return d})}var d=g("$interpolate-interpolateWrap",function(){var a=b.apply(this,arguments);return a?c(a,arguments):void 0});return angular.extend(d,b),d}]),b.decorator("$browser",["$delegate",function(a){return a.cookies=function(){return{}},a}]))}]).factory("$exceptionHandler",function(){function a(a,b){n.sendBugReport(n.IRRELEVANT_GAME_ID,a,b,"")}return window.onerror=function(b,c,d,e,f){a(f,"window.onerror: "+angular.toJson(b,!0)+" in script: "+c+" Line: "+d+" Column: "+e)},a});var m=!1;angular.element(document).ready(function(){m||(m=!0,angular.bootstrap(document,["myApp"]))});var n;!function(b){function c(a){if(!a)return[];for(var b=[],c=0,d=a.length-1;d>=0;d--){var e=a[d];if(c+=angular.toJson(e).length,c>2e4)break;b.push(e)}return a}function d(d,e){a.log.error("Sending exception"),d||(d=b.IRRELEVANT_GAME_ID),e&&"string"!=typeof e||(e={gameUrl:location.toString(),exception:e});var f={location:""+e.gameUrl,exception:""+e.exception,stack:""+e.stack,cause:""+e.cause,compilationDate:a.compilationDate,gameLogs:c(e.gameLogs),platformLogs:c(a.log.getLogs()),navigator:g(),userFeedback:""};h(d,f)}function f(d,e,f,i){a.log.error("Sending exception: ",e),d||(d=b.IRRELEVANT_GAME_ID);var j={location:""+location,exception:""+e,stack:""+(e?e.stack:"no exception"),cause:""+f,compilationDate:a.compilationDate,gameLogs:null,platformLogs:c(a.log.getLogs()),navigator:g(),userFeedback:i};h(d,j)}function g(){return{appName:navigator.appName,appCodeName:navigator.appCodeName,platform:navigator.platform,appVersion:navigator.appVersion,product:navigator.product,userAgent:navigator.userAgent,vendor:navigator.vendor}}function h(b,c){e(c.userFeedback?"userFeedback":c.gameLogs?"gameException":"platformException","");var d={gameId:b,label:"UNASSIGNED",fields:c};if(a.log.error("Sending bug report:",d),"localhost"===location.hostname||/^\d+\./.test(location.hostname))throw new Error("We had an error while local testing. It won't be saved on the server.");if("file:"===location.protocol)return a.log.log("In production, we would have sent this bug report: ",angular.toJson(d,!0)),void window.alert("We had an error, please check in the console and fix the error now :) It won't be saved on the server.");if(i)return void a.log.error("Already sent a bug report, so not sending any more...");i=!0;var f=[{addBugReport:d}];o.makeAjaxCallNoRetry("addBugReport",angular.toJson(f),function(b){b||a.serverApi.sendMessages(f,function(a){})})}b.IRRELEVANT_GAME_ID="irrelevantGameId",b.sendGameException=d,b.sendBugReport=f;var i=!1}(n=a.bugReport||(a.bugReport={}));var o;!function(b){function c(b,c,d){a.$http({method:"POST",url:"http://multiplayer-gaming.appspot.com/msg/"+b,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},data:c}).then(function(b){a.log.log("AppEngine returns: ",b);var c=b.data;d(c)},function(b){a.log.error("AppEngine had an error: ",b),d(null)})}b.makeAjaxCallNoRetry=c}(o=a.appEngine||(a.appEngine={}));var p;!function(a){function b(a){if(f)return f;f=[];var b=c(),d=a.languageToLocalizedGameFields;for(var e in d)f.push({code:e,name:b[e]});return f.sort(function(a,b){return a.name.localeCompare(b.name)}),f}function c(){for(var a=[["English","en"],["中文","zh"],["हिन्दी","hi"],["עברית","iw"],["Deutsch","de"],["čeština","cs"],["Nederlands","nl"],["French","fr"],["italiano","it"],["Japanese","ja"],["Korean","ko"],["polski","pl"],["Русский язык","ru"],["español","es"],["العربية","ar"],["български","bg"],["català","ca"],["Hrvatski","hr"],["dansk","da"],["suomi","fi"],["ελληνικά","el"],["magyar","hu"],["Bahasa Indonesia","in"],["latviešu valoda","lv"],["lietuvių kalba","lt"],["norsk","nb"],["português","pt"],["român","ro"],["српски","sr"],["slovenčina","sk"],["slovenščina","sl"],["svenska","sv"],["Tagalog","tl"],["ภาษาไทย","th"],["Türkçe","tr"],["Українська","uk"],["tiếng việt (㗂越)","vi"]],b={},c=0;c<a.length;c++){var d=a[c],e=d[1];if(e.toLowerCase()!==e)throw new Error("lowercase lang code "+e);var f=d[0];b[e]=f}return b}function d(a){for(var b=0,c=e();b<c.length;b++){var d=c[b],f=d.split("-")[0].toLowerCase();if(a[f])return f}return a.en?"en":Object.keys(a)[0]}function e(){var a=[],b=window.navigator,c=["language","browserLanguage","systemLanguage","userLanguage"];if(b.languages)for(var d=0,e=b.languages;d<e.length;d++){var f=e[d];f&&f.length&&a.push(f)}for(var g=b,h=0;h<c.length;h++){var i=c[h],j=g[i];j&&j.length&&a.push(j)}return a}var f=null;a.getSupportedLanguages=b,a.getLanguageCodeToName=c,a.getBestLanguage=d}(p=a.i18nCommon||(a.i18nCommon={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(b){function c(b,c){a.appEngine.makeAjaxCallNoRetry("bugReport",angular.toJson([{addBugReport:a.bugReport}]),function(a){})}b.sendMessages=c}(b=a.serverApi||(a.serverApi={}));var c;!function(a){function b(){return a.gameId}a.gameId="unknown",a.getGameId=b}(c=a.gamesService||(a.gamesService={}));var d;!function(b){function d(){return!E}function e(c){a.log.log("Language changed to: ",c),b.ModelModule.currentLanguage=c,y=x.languageToLocalizedGameFields[c],a.translate.setLanguage(c),a.defaultTranslateInterpolateParams={GAME_NAME:y.gameName},w&&(a.defaultTranslateInterpolateParams.PLAYER_NAME=w.displayName)}function f(){return a.i18nCommon.getSupportedLanguages(x)}function g(){E=!1}function h(b){var c="APPLE"==b?A+x.iosAppId:B+"com.gamingplatform."+x.lowercaseGameName;a.log.log("Openning url in a new window=",c),window.open(c)}function i(b){a.log.log("setLocation url=",b),window.location.assign(b)}function j(){if(x.iosAppId){var a=document.createElement("meta");a.name="apple-itunes-app",a.content="app-id="+x.iosAppId+", app-argument="+x.lowercaseGameName+"://",document.head.appendChild(a)}}function k(){return C||D}function l(){var b=(x.iosAppId,x.lowercaseGameName),c="com.gamingplatform."+b;if(D){var d="intent://#Intent;package="+c+";scheme="+b+";launchFlags=268435456;end;";i(d)}else{var e=[],f=function(){a.log.log("Clearing timers: ["+e.join(", ")+"]"),e.map(clearTimeout),e=[]},g=b+"://";(new Date).getTime();setTimeout(function(){var b=!1;e.push(window.setTimeout(function(){b=!0;var c=A+x.iosAppId;a.log.log("Launching App Store: "+c),window.top.location.assign(c)},200)),e.push(window.setTimeout(function(){a.log.log("Reloading page"),b&&window.location.reload()},2e3));var c=["pagehide","blur","beforeunload"];a.log.log("Listening window events: "+c.join(", "));for(var d=0;d<c.length;d++){var h=c[d];window.addEventListener(h,f)}a.log.log("Launching app on ios: "+g),i(g)},0)}}function m(d){var f=d.game;return c.gameId=f.gameId,w=d.player,x=f.gameFields,b.ModelModule.currentLanguage=a.i18nCommon.getBestLanguage(x.languageToLocalizedGameFields),a.log.log("Best language is: ",b.ModelModule.currentLanguage),e(b.ModelModule.currentLanguage),g(),j(),x.iosAppId||(C=!1),x.lowercaseGameName?void 0:void a.log.error("The game "+y.gameName+" didn't set lowercaseGameName! Please email this issue to "+f.gameDeveloperEmail)}function n(b,c){a.appEngine.makeAjaxCallNoRetry("storeGameInviteRequest",b,function(a){c(a)})}function o(){for(var b=location.search?location.search.substr(1):"",d="=",e=0;e<F.length;e++){var f=F[e];if(-1!==b.indexOf(f)){d=f;break}}var g=b.split(d),h=g[0],i=g[1];h&&(h=decodeURIComponent(h)),i&&(i=decodeURIComponent(i)),h||(h="yoav.zibin"),i||(i="tictactoe"),c.gameId=i,a.log.log("makeServerApiCall: userName=",h," gameName=",i);var j={playerIdOrUserName:h,gameIdOrGameName:i},k={storeGameInviteRequest:j};n(JSON.stringify([k]),function(b){return!b||1!=b.length||b[0].error?void a.log.error("Error in result of serverApi call! Most likely gameName=",i," was wrong! responseArr=",b):void m(b[0].storeGameInviteResponse)})}function p(){return b.ModelModule}function q(){return b.L10nModule}function r(){return y.gameHeader320x50Url?y.gameHeader320x50Url:""}function s(){return y.gameIcon50x50Url?y.gameIcon50x50Url:""}function t(){return!!x.iosAppId}function u(){return w?w.displayName:""}function v(){return w?w.avatarImageUrl:""}var w,x,y,z=navigator.userAgent.toLowerCase(),A="http://itunes.apple.com/app/id",B="https://play.google.com/store/apps/details?id=",C=z.indexOf("iphone")>-1||z.indexOf("ipod")>-1||z.indexOf("ipad")>-1,D=z.indexOf("android")>-1,E=!0;b.isFinishedLoading=d,b.changeLanguage=e,b.getSupportedLanguages=f,b.openLocation=h,b.isMobile=k,b.openOrInstallApp=l;var F=["/","%2F","="];b.makeServerApiCall=o,b.ModelModule={currentLanguage:"en"},b.L10nModule={getSupportedLanguages:b.getSupportedLanguages,changeLanguage:a.wrapWithLogApi("changeLanguage",b.changeLanguage),translate:a.translate,setTranslations:a.wrapWithLogApi("setTranslations",a.translate.setTranslations)},b.model=p,b.l10n=q,b.gameHeader320x50Url=r,b.gameIcon50x50Url=s,b.hasIosApp=t,b.getDisplayName=u,b.getAvatarImage=v}(d=a.mainModule||(a.mainModule={}));var e;!function(b){b.main={isMobile:d.isMobile,hasIosApp:d.hasIosApp,openOrInstallApp:a.wrapWithLogApi("openOrInstallApp",d.openOrInstallApp),openLocation:a.wrapWithLogApi("openLocation",d.openLocation),gameHeader320x50Url:d.gameHeader320x50Url,gameIcon50x50Url:d.gameIcon50x50Url,getDisplayName:d.getDisplayName,getAvatarImage:d.getAvatarImage,isFinishedLoading:d.isFinishedLoading,model:d.model,l10n:d.l10n}}(e=a.gameinvite||(a.gameinvite={})),angular.module("myApp").run(["$rootScope","$timeout","$interval","$sce","$interpolate","$templateCache","$http",function(b,c,f,g,h,i,j){a.log.log("myApp module created"),a.$rootScope=b,a.$timeout=c,a.$interval=f,a.$sce=g,a.$interpolate=h,a.$templateCache=i,a.$http=j,a.$rootScope.main=e.main,d.makeServerApiCall()}])}(gamingPlatform||(gamingPlatform={})),(gamingPlatform=gamingPlatform||{}).compilationDate="2016-04-08_21",function(){var a={GAME_INVITE_INSTALL_APP_FROM:{en:"Install {{GAME_NAME}} app from: ",iw:"התקן את האפליקציה {{GAME_NAME}}  מ:",pt:"Installar {{GAME_NAME}}",zh:"安装{{GAME_NAME}}游戏从：",el:"",fr:"Installez l'application {{GAME_NAME}} à partir de",hi:"{{GAME_NAME}} अनुप्रयोग से स्थापित करें:",es:"Instalar {{GAME_NAME}} app desde:"},GAME_INVITE_INSTALL_APP_FROM_APPLE_APPSTORE:{en:"AppStore (for iPhones or iPads)",iw:"חנות האפליקציות של אפל",pt:"AppStore (para iPhones ou iPads)",zh:"苹果商店（对于苹果手机或平板）",el:"",fr:"AppStore ( pour les iPhones ou iPads )",hi:"ऐप स्टोर ( आईफ़ोन या आईपैड के लिए )",es:"AppStore (para iPhones y iPads)"},GAME_INVITE_INSTALL_APP_FROM_GOOGLE_PLAY:{en:"Google Play (for Android phones)",iw:"חנות האפליקציות של גוגל",pt:"Google Play (para telefones Android)",zh:"谷歌玩玩（对于安桌手机）",el:"",fr:"Google Play ( pour les portables Android )",hi:"( एंड्रॉयड फोन के लिए ) गूगल प्ले",es:"Google Play (para dispositivos Android)"},GAME_INVITE_OPEN_OR_INSTALL_GAME_NAME:{en:"Open or install {{GAME_NAME}}",iw:"פתח או התקן {{GAME_NAME}}",pt:"Abrir ou installar {{GAME_NAME}}",zh:"打开或者安装{{GAME_NAME}}",el:"",fr:"Ouvrez ou installer {{GAME_NAME}}",hi:"खोलें या स्थापित करें {{GAME_NAME}}",es:"Abrir o instalar {{GAME_NAME}}"},GAME_INVITE_PLAYER_NAME_WANTS_TO_PLAY_GAME_NAME_WITH_YOU:{en:"{{PLAYER_NAME}} wants to play {{GAME_NAME}} with you!",iw:"{{PLAYER_NAME}} רוצה לשחק איתך {{GAME_NAME}}!",pt:"{{PLAYER_NAME}} quer jogar {{GAME_NAME}} com você",zh:"{{PLAYER_NAME}}想和你一起玩{{GAME_NAME}}",el:"",fr:"{PLAYER_NAME}} veut jouer {{GAME_NAME}} avec vous!",hi:"{{PLAYER_NAME}} खेलना चाहता {{GAME_NAME}} आप के साथ !",es:"{{PLAYER_NAME}} quiere jugar {{GAME_NAME}} contigo!"}};gamingPlatform.gameinvite.main.l10n().setTranslations(a)}();
//# sourceMappingURL=gameinvite.min.js.map