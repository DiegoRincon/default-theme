!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=t&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=t&f+1],c=c*d+h[t&(h[f]=h[g=t&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){return b.i=a.i,b.j=a.j,b.S=a.S.slice(),b}function l(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(l(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\x00"}function m(a,b){for(var c,d=a+"",e=0;e<d.length;)b[t&e]=t&(c^=19*b[t&e])+d.charCodeAt(e++);return o(b)}function n(c){try{return p?o(p.randomBytes(d)):(a.crypto.getRandomValues(c=new Uint8Array(d)),o(c))}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,o(b)]}}function o(a){return String.fromCharCode.apply(0,a)}var p,q=c.pow(d,e),r=c.pow(2,f),s=2*r,t=d-1,u=c["seed"+i]=function(a,f,g){var h=[];f=1==f?{entropy:!0}:f||{};var p=m(l(f.entropy?[a,o(b)]:null==a?n():a,3),h),t=new j(h);return m(o(t.S),b),(f.pass||g||function(a,b,d,e){return e&&(e.S&&k(e,t),a.state=function(){return k(t,{})}),d?(c[i]=a,b):a})(function(){for(var a=t.g(e),b=q,c=0;r>a;)a=(a+c)*d,b*=d,c=t.g(1);for(;a>=s;)a/=2,b/=2,c>>>=1;return(a+c)/b},p,"global"in f?f.global:this==c,f.state)};if(m(c[i](),b),g&&g.exports){g.exports=u;try{p=require("crypto")}catch(v){}}else h&&h.amd&&h(function(){return u})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");var LZString={_f:String.fromCharCode,_keyStrBase64:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_keyStrUriSafe:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",_getBaseValue:function(a,b){if(LZString._baseReverseDic||(LZString._baseReverseDic={}),!LZString._baseReverseDic[a]){LZString._baseReverseDic[a]={};for(var c=0;c<a.length;c++)LZString._baseReverseDic[a][a[c]]=c}return LZString._baseReverseDic[a][b]},compressToBase64:function(a){if(null==a)return"";var b=LZString._compress(a,6,function(a){return LZString._keyStrBase64.charAt(a)});switch(b.length%4){default:case 0:return b;case 1:return b+"===";case 2:return b+"==";case 3:return b+"="}},decompressFromBase64:function(a){return null==a?"":""==a?null:LZString._decompress(a.length,32,function(b){return LZString._getBaseValue(LZString._keyStrBase64,a.charAt(b))})},compressToUTF16:function(a){return null==a?"":LZString._compress(a,15,function(a){return String.fromCharCode(a+32)})+" "},decompressFromUTF16:function(a){return null==a?"":""==a?null:LZString._decompress(a.length,16384,function(b){return a.charCodeAt(b)-32})},compressToUint8Array:function(a){for(var b=LZString.compress(a),c=new Uint8Array(2*b.length),d=0,e=b.length;e>d;d++){var f=b.charCodeAt(d);c[2*d]=f>>>8,c[2*d+1]=f%256}return c},decompressFromUint8Array:function(a){if(null===a||void 0===a)return LZString.decompress(a);for(var b=new Array(a.length/2),c=0,d=b.length;d>c;c++)b[c]=256*a[2*c]+a[2*c+1];var e=[];return b.forEach(function(a){e.push(String.fromCharCode(a))}),LZString.decompress(e.join(""))},compressToEncodedURIComponent:function(a){return null==a?"":LZString._compress(a,6,function(a){return LZString._keyStrUriSafe.charAt(a)})},decompressFromEncodedURIComponent:function(a){return null==a?"":""==a?null:(a=a.replace(/ /g,"+"),LZString._decompress(a.length,32,function(b){return LZString._getBaseValue(LZString._keyStrUriSafe,a.charAt(b))}))},compress:function(a){return LZString._compress(a,16,function(a){return String.fromCharCode(a)})},_compress:function(a,b,c){if(null==a)return"";var d,e,f,g={},h={},i="",j="",k="",l=2,m=3,n=2,o=[],p=0,q=0;LZString._f;for(f=0;f<a.length;f+=1)if(i=a[f],Object.prototype.hasOwnProperty.call(g,i)||(g[i]=m++,h[i]=!0),j=k+i,Object.prototype.hasOwnProperty.call(g,j))k=j;else{if(Object.prototype.hasOwnProperty.call(h,k)){if(k.charCodeAt(0)<256){for(d=0;n>d;d++)p<<=1,q==b-1?(q=0,o.push(c(p)),p=0):q++;for(e=k.charCodeAt(0),d=0;8>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}else{for(e=1,d=0;n>d;d++)p=p<<1|e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e=0;for(e=k.charCodeAt(0),d=0;16>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}l--,0==l&&(l=Math.pow(2,n),n++),delete h[k]}else for(e=g[k],d=0;n>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1;l--,0==l&&(l=Math.pow(2,n),n++),g[j]=m++,k=String(i)}if(""!==k){if(Object.prototype.hasOwnProperty.call(h,k)){if(k.charCodeAt(0)<256){for(d=0;n>d;d++)p<<=1,q==b-1?(q=0,o.push(c(p)),p=0):q++;for(e=k.charCodeAt(0),d=0;8>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}else{for(e=1,d=0;n>d;d++)p=p<<1|e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e=0;for(e=k.charCodeAt(0),d=0;16>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}l--,0==l&&(l=Math.pow(2,n),n++),delete h[k]}else for(e=g[k],d=0;n>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1;l--,0==l&&(l=Math.pow(2,n),n++)}for(e=2,d=0;n>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1;for(;;){if(p<<=1,q==b-1){o.push(c(p));break}q++}return o.join("")},decompress:function(a){return null==a?"":""==a?null:LZString._decompress(a.length,32768,function(b){return a.charCodeAt(b)})},_decompress:function(a,b,c){var d,e,f,g,h,i,j,k,l=[],m=4,n=4,o=3,p="",q=[],r=LZString._f,s={val:c(0),position:b,index:1};for(e=0;3>e;e+=1)l[e]=e;for(g=0,i=Math.pow(2,2),j=1;j!=i;)h=s.val&s.position,s.position>>=1,0==s.position&&(s.position=b,s.val=c(s.index++)),g|=(h>0?1:0)*j,j<<=1;switch(d=g){case 0:for(g=0,i=Math.pow(2,8),j=1;j!=i;)h=s.val&s.position,s.position>>=1,0==s.position&&(s.position=b,s.val=c(s.index++)),g|=(h>0?1:0)*j,j<<=1;k=r(g);break;case 1:for(g=0,i=Math.pow(2,16),j=1;j!=i;)h=s.val&s.position,s.position>>=1,0==s.position&&(s.position=b,s.val=c(s.index++)),g|=(h>0?1:0)*j,j<<=1;k=r(g);break;case 2:return""}for(l[3]=k,f=k,q.push(k);;){if(s.index>a)return"";for(g=0,i=Math.pow(2,o),j=1;j!=i;)h=s.val&s.position,s.position>>=1,0==s.position&&(s.position=b,s.val=c(s.index++)),g|=(h>0?1:0)*j,j<<=1;switch(k=g){case 0:for(g=0,i=Math.pow(2,8),j=1;j!=i;)h=s.val&s.position,s.position>>=1,0==s.position&&(s.position=b,s.val=c(s.index++)),g|=(h>0?1:0)*j,j<<=1;l[n++]=r(g),k=n-1,m--;break;case 1:for(g=0,i=Math.pow(2,16),j=1;j!=i;)h=s.val&s.position,s.position>>=1,0==s.position&&(s.position=b,s.val=c(s.index++)),g|=(h>0?1:0)*j,j<<=1;l[n++]=r(g),k=n-1,m--;break;case 2:return q.join("")}if(0==m&&(m=Math.pow(2,o),o++),l[k])p=l[k];else{if(k!==n)return null;p=f+f[0]}q.push(p),l[n++]=f+p[0],m--,f=p,0==m&&(m=Math.pow(2,o),o++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=LZString),(gamingPlatform=gamingPlatform||{}).codeInjectedIntoPhonegap='var gamingPlatform;!function(a){var b;!function(b){function c(){if(g()?a.log.info("In default theme, so this code is normally included, and not injected"):(j("Not in default theme, so adding window.onerror and gotMessage"),r.onerror=function(){k({hadPhonegapError:arguments})},r.gotMessage=d),!r.cordova)return void i("Phonegap didn\'t find cordova, so this is not inside phonegap.");r.PushNotification||(i(\'Phonegap did not find PushNotification plugin! Add to your config.xml this plugin: <gap:plugin name="phonegap-plugin-push" source="npm" version="1.2.3" />\'),r.PushNotification={init:function(){return{on:function(){}}}}),r.facebookConnectPlugin||(i(\'Phonegap did not find facebookConnectPlugin! Did you add to your config.xml this plugin: <gap:plugin name="com.phonegap.plugins.facebookconnect" ...\'),r.facebookConnectPlugin={browserInit:function(){},login:function(){},getLoginStatus:function(){},logout:function(){},showDialog:function(){}}),p=r.facebookConnectPlugin,q="android"==r.cordova.platformId||"Android"==r.cordova.platformId||"amazon-fireos"==r.cordova.platformId,i("isAndroid=",q," Phonegap platformId=",r.cordova.platformId),document.addEventListener("resume",function(){k({phonegapResumed:!0})});var b=r.PushNotification.init({android:{senderID:"24803504516",clearNotifications:!1},ios:{alert:!0,badge:!0,sound:!0,clearBadge:!0},windows:{}});b.on("registration",m),b.on("notification",n),b.on("error",o)}function d(a){if(r.cordova){i("Phonegap start handling message: ",a);var b=a.appId;switch(a.type){case 1:var c=a.permissions;l(b),p.login(c,h,h);break;case 0:l(b),p.getLoginStatus(h,h);break;case 2:l(b),p.logout(h,h);break;case 3:s.app?s.app.exitApp():s.device&&s.device.exitApp();break;case 4:e(a.shareOptions)}i("Phonegap finished handling message: ",a)}}function e(a){a.takePrintscreen?s.screenshot&&s.screenshot.URI?s.screenshot.URI(function(b,c){if(i("navigator.screenshot.URI error=",b," res=",c&&c.URI?c.URI.substring(0,100):c),b||!c||!c.URI)return void f(a);var d=c.URI;a.image=d,f(a)}):(i(\'Missing screenshot plugin! You need to add to your config.xml: <gap:plugin name="it.zerob.cordova.screenshot" source="pgb" version="0.1.3" />\'),f(a)):f(a)}function f(a){return r.plugins&&r.plugins.socialsharing&&r.plugins.socialsharing.share?void(a.toEmail?r.plugins.socialsharing.shareViaEmail(a.message,a.subject,[a.toEmail],null,null,null,function(){},function(){}):r.plugins.socialsharing.share(a.message,a.subject,a.image,a.link)):void i(\'Missing socialsharing plugin! You need to add to your config.xml: <gap:plugin name="nl.x-services.plugins.socialsharing" />\')}function g(){return a.urlParams&&a.urlParams.phonegapPlugins}function h(a){k({fbLoginStatus:a})}function i(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return g()?void a.log.info(b):void k({addLog:b})}function j(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];console&&console.log&&console.log(a)}function k(b){if(j("Phonegap sends message:",b),g())return void a.$timeout(function(){return a.phoneGapService.onMessageRecieve(b)},0);var c=document.getElementById("platform_iframe");c?c.contentWindow.postMessage(b,"*"):j("Not in phonegap or platform_iframe is undefined.")}function l(a){t||(t=!0,"browser"==r.cordova.platformId&&(j("fbBrowserInit with appId="+a),p.browserInit(a)))}function m(a){var b=q?"ANDROID":"IOS",c=a.registrationId;j(["PushNotification registration:",a,"device token = ",c," platformType=",b]);var d={registrationId:c,platformType:b};k({registerForPushNotifications:d})}function n(a){i("PushNotification notification:",a),a.additionalData&&k({gotPushNotification:{matchInfoJson:a.additionalData.matchInfoJson,gotChatJson:a.additionalData.gotChatJson,coldstart:a.additionalData.coldstart,foreground:a.additionalData.foreground,matchId:a.additionalData.matchId,updatedTimestampMillis:a.additionalData.updatedTimestampMillis}})}function o(a){i("PushNotification error:",a)}var p,q,r=window,s=window.navigator;c(),b.gotMessage=d;var t=!1}(b=a.phonegapCode||(a.phonegapCode={}))}(gamingPlatform||(gamingPlatform={}));',(gamingPlatform=gamingPlatform||{}).compilationDate="2016-04-05_14";var gamingPlatform;!function(a){var b=function(){function a(){}return a.NORMAL="NORMAL",a.DISMISSED="DISMISSED",a}();a.IEndMatchReason=b;var c=function(){function a(){}return a.UNKNOWN_REASON="UNKNOWN_REASON",a.WRONG_VALUE_IN_FIELD="WRONG_VALUE_IN_FIELD",a.EMPTY_VALUE_IN_FIELD="EMPTY_VALUE_IN_FIELD",a.FIELD_MUST_BE_NULL="FIELD_MUST_BE_NULL",a.FIELD_NOT_FOUND="FIELD_NOT_FOUND",a.ILLEGAL_BASE64_STRING="ILLEGAL_BASE64_STRING",a.FIELD_ALREADY_EXIST="FIELD_ALREADY_EXIST",a.PLAYER_NOT_IN_MATCH="PLAYER_NOT_IN_MATCH",a.PLAYER_BLOCKED="PLAYER_BLOCKED",a.RECAPTCHA_REQUIRED="RECAPTCHA_REQUIRED",a.CANNOT_CREATE_NEW_MATCH_BECAUSE_MAX_MATCHES_PER_PLAYER_EXCEEDED="CANNOT_CREATE_NEW_MATCH_BECAUSE_MAX_MATCHES_PER_PLAYER_EXCEEDED",a.NUMBER_OF_PLAYERS_IS_ILLEGAL="NUMBER_OF_PLAYERS_IS_ILLEGAL",a.MATCH_ALREADY_ENDED="MATCH_ALREADY_ENDED",a.MATCH_ALREADY_DISMISSED="MATCH_ALREADY_DISMISSED",a.NOT_YOUR_MOVE="NOT_YOUR_MOVE",a.AUTO_MATCH_ALREADY_FULL="AUTO_MATCH_ALREADY_FULL",a.PRINTSCREEN_TOO_BIG="PRINTSCREEN_TOO_BIG",a.GAME_DEVELOPER_EMAIL_EXISTS_PASSWORD_RESENT="GAME_DEVELOPER_EMAIL_EXISTS_PASSWORD_RESENT",a.ALREADY_SENT_EMAIL_TO_RECIPIENT_TODAY="ALREADY_SENT_EMAIL_TO_RECIPIENT_TODAY",a.SENT_TOO_MANY_EMAILS_IN_TOTAL_TODAY="SENT_TOO_MANY_EMAILS_IN_TOTAL_TODAY",a.EMAIL_UNSUBSCRIBED="EMAIL_UNSUBSCRIBED",a}();a.IApiReason=c;var d=function(){function a(){}return a.ANDROID="ANDROID",a.IOS="IOS",a}();a.IPlatformType=d;var e=function(){function a(){}return a.E="E",a.F="F",a.G="G",a}();a.IUniqueType=e;var f=function(){function a(){}return a.CLOSURE_TYPES_RESULT="CLOSURE_TYPES_RESULT",a.TYPE_DESCRIPTIONS_RESULT="TYPE_DESCRIPTIONS_RESULT",a}();a.IServerApiResult=f;var g=function(){function a(){}return a.BugReport="BugReport",a.AutoMatch="AutoMatch",a.Match="Match",a.Player="Player",a.UniqueToPlayer="UniqueToPlayer",a.GameDeveloper="GameDeveloper",a.LowercaseGameName="LowercaseGameName",a.UserNameToId="UserNameToId",a.GameInvite="GameInvite",a.UnsubscribeEmail="UnsubscribeEmail",a}();a.IDbEntityType=g;var h=function(){function a(){}return a.ALWAYS="ALWAYS",a.LOG="LOG",a.INFO="INFO",a.DEBUG="DEBUG",a.WARN="WARN",a.ERROR="ERROR",a}();a.ILogLevel=h}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){function b(){var a=location.search.substr(1),b={};return a.split("&").forEach(function(a){var c=a.split("=");b[c[0]]=decodeURIComponent(c[1])}),b}a.urlParams=b(),console.log("urlParams set to: ",a.urlParams)}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(a){function b(){return window.performance?window.performance.now():(new Date).getTime()}function c(a,c,d){var e=b()-o,f=Math.round(e)/1e3,g=["",f," seconds:"].concat(a);return d.apply(console,g),{millisecondsFromStart:e,args:a,logLevel:c}}function d(a,b,d){n.length>100&&n.shift(),n.push(c(a,b,d))}function e(){return n.concat(m)}function f(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];m.push(c(a,l.ALWAYS,console.log))}function g(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.INFO,console.log)}function h(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.DEBUG,console.debug)}function i(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.WARN,console.warn)}function j(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.ERROR,console.error)}function k(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];d(a,l.LOG,console.log)}var l=function(){function a(){}return a.ALWAYS="ALWAYS",a.LOG="LOG",a.INFO="INFO",a.DEBUG="DEBUG",a.WARN="WARN",a.ERROR="ERROR",a}(),m=[],n=[],o=b();a.getCurrentTime=b,a.getLogs=e,a.alwaysLog=f,a.info=g,a.debug=h,a.warn=i,a.error=j,a.log=k}(b=a.log||(a.log={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){function b(){function b(b,d,g){g||(g=c);var h=null;if(f&&f[b]){var i=f[b];h=i[g],h||(h=i.en)}else h=e[b];return h||(h="["+b+"]",a.log.error("Couldn't find translationId="+b+" in language="+g)),a.$interpolate(h)(d||{})}var c,d,e=null,f=null;return d=b,d.getLanguage=function(){return c},d.setTranslations=function(a){f=a},d.setLanguage=function(a,b){c=a,e=b},d}a.translate=b(),a.defaultTranslateInterpolateParams={},angular.module("translate",[]).filter("translate",["$parse",function(b){var c=function(c,d){return angular.isObject(d)||(d=b(d)(this)),d||(d=a.defaultTranslateInterpolateParams),a.translate(c,d)};return c.$stateful=!0,c}])}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){function b(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];a.log.info("Sending Google Analytics: ",b,c),k.push([l+"."+b].concat(c))}function c(a,c){b("set",a,c)}function d(a,c,d){b("send","timing",{timingCategory:a,timingVar:c,timingValue:d})}function e(c,d){setTimeout(function(){b("send","event",c,d,{dimension1:a.gamesService.getGameId()})},0)}function f(b,c){if(a.log.info("Loading script ",c," into script element with id=",b),document.getElementById(b))return void a.log.error("Already loaded src=",c);var d=document.createElement("script");d.src=c,d.id=b,d.onload=function(){a.log.info("Loaded script ",c)},d.async=1,d.crossorigin="anonymous";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(d,e)}function g(b,c){return function(){try{return c.apply(this,arguments)}catch(d){throw a.log.error("Got an exception when calling ",b," with arguments ",arguments," exception=",d,d.stack),d}}}function h(b,c){var d=function(){return a.log.log("Api call for method=",b," with arguments=",arguments," this=",this),e("api",b),c.apply(this,arguments),!0};return d}function i(){return-1!==location.toString().indexOf("gameDeveloper")}function j(){try{return angular.module("ngRoute"),!0}catch(a){return!1}}var k,l="gamingPlatformTracker";a.setAnalyticsField=c,a.sendAnalyticsTiming=d,a.sendAnalyticsEvent=e,a.createScriptWithCrossorigin=f,function(){var a=window,c=a.GoogleAnalyticsObject||"gamingPlatformGoogleAnalytics";a.GoogleAnalyticsObject=c,a[c]=a[c]||function(){a[c].q.push(arguments)};var d=a[c];d.q=d.q||[],k=d.q,d.l=d.l||1*(new Date).getTime(),d("create","UA-56887721-1","auto",l),b("require","displayfeatures"),b("send","pageview")}(),a.logAndRethrow=g,a.wrapWithLogApi=h,a.isGameDeveloperSite=i,angular.module("myApp",["translate"].concat(j()?["ngRoute"]:[])).config(["$provide",function(b){i()||(b.decorator("$parse",["$delegate",function(b){return function(c,d,e){var f=b(c,d,e),h=g(["$parse-delegate: ",c],function(){var b=f.apply(this,arguments);return void 0===b&&"string"==typeof c&&c&&-1===c.indexOf("main.model().")&&a.log.error("You probably misspelled something in expression '",c,"', because it returned undefined in $parse!"),b});for(var i in f)h[i]=f[i];return h}}]),b.decorator("$interpolate",["$delegate",function(b){function c(b,c){return g(["$interpolate-interpolationFnWrap:",c],function(){var d=b.apply(this,arguments);if(!d){var e=c[0];e&&(e=e.trim()),e&&a.log.error("You probably misspelled something in expression '",e,"', because it returned something falsy (",d,") in $interpolate!")}return d})}var d=g("$interpolate-interpolateWrap",function(){var a=b.apply(this,arguments);return a?c(a,arguments):void 0});return angular.extend(d,b),d}]),b.decorator("$browser",["$delegate",function(a){return a.cookies=function(){return{}},a}]))}]).factory("$exceptionHandler",function(){function a(a,b){n.sendBugReport(n.IRRELEVANT_GAME_ID,a,b,"")}return window.onerror=function(b,c,d,e,f){a(f,"window.onerror: "+angular.toJson(b,!0)+" in script: "+c+" Line: "+d+" Column: "+e)},a});var m=!1;angular.element(document).ready(function(){m||(m=!0,angular.bootstrap(document,["myApp"]))});var n;!function(b){function c(a){if(!a)return[];for(var b=[],c=0,d=a.length-1;d>=0;d--){var e=a[d];if(c+=angular.toJson(e).length,c>2e4)break;b.push(e)}return a}function d(d,e){a.log.error("Sending exception"),d||(d=b.IRRELEVANT_GAME_ID),e&&"string"!=typeof e||(e={gameUrl:location.toString(),exception:e});var f={location:""+e.gameUrl,exception:""+e.exception,stack:""+e.stack,cause:""+e.cause,compilationDate:a.compilationDate,gameLogs:c(e.gameLogs),platformLogs:c(a.log.getLogs()),navigator:g(),userFeedback:""};h(d,f)}function f(d,e,f,i){a.log.error("Sending exception: ",e),d||(d=b.IRRELEVANT_GAME_ID);var j={location:""+location,exception:""+e,stack:""+(e?e.stack:"no exception"),cause:""+f,compilationDate:a.compilationDate,gameLogs:null,platformLogs:c(a.log.getLogs()),navigator:g(),userFeedback:i};h(d,j)}function g(){return{appName:navigator.appName,appCodeName:navigator.appCodeName,platform:navigator.platform,appVersion:navigator.appVersion,product:navigator.product,userAgent:navigator.userAgent,vendor:navigator.vendor}}function h(b,c){e(c.userFeedback?"userFeedback":c.gameLogs?"gameException":"platformException","");var d={gameId:b,label:"UNASSIGNED",fields:c};if(a.log.error("Sending bug report:",d),"localhost"===location.hostname||/^\d+\./.test(location.hostname))throw new Error("We had an error while local testing. It won't be saved on the server.");if("file:"===location.protocol)return a.log.log("In production, we would have sent this bug report: ",angular.toJson(d,!0)),void window.alert("We had an error, please check in the console and fix the error now :) It won't be saved on the server.");if(i)return void a.log.error("Already sent a bug report, so not sending any more...");i=!0;var f=[{addBugReport:d}];o.makeAjaxCallNoRetry("addBugReport",angular.toJson(f),function(b){b||a.serverApi.sendMessages(f,function(a){})})}b.IRRELEVANT_GAME_ID="irrelevantGameId",b.sendGameException=d,b.sendBugReport=f;var i=!1}(n=a.bugReport||(a.bugReport={}));var o;!function(b){function c(b,c,d){a.$http({method:"POST",url:"http://multiplayer-gaming.appspot.com/msg/"+b,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},data:c}).then(function(b){a.log.log("AppEngine returns: ",b);var c=b.data;d(c)},function(b){a.log.error("AppEngine had an error: ",b),d(null)})}b.makeAjaxCallNoRetry=c}(o=a.appEngine||(a.appEngine={}));var p;!function(a){function b(a){if(f)return f;f=[];var b=c(),d=a.languageToLocalizedGameFields;for(var e in d)f.push({code:e,name:b[e]});return f.sort(function(a,b){return a.name.localeCompare(b.name)}),f}function c(){for(var a=[["English","en"],["中文","zh"],["हिन्दी","hi"],["עברית","iw"],["Deutsch","de"],["čeština","cs"],["Nederlands","nl"],["French","fr"],["italiano","it"],["Japanese","ja"],["Korean","ko"],["polski","pl"],["Русский язык","ru"],["español","es"],["العربية","ar"],["български","bg"],["català","ca"],["Hrvatski","hr"],["dansk","da"],["suomi","fi"],["ελληνικά","el"],["magyar","hu"],["Bahasa Indonesia","in"],["latviešu valoda","lv"],["lietuvių kalba","lt"],["norsk","nb"],["português","pt"],["român","ro"],["српски","sr"],["slovenčina","sk"],["slovenščina","sl"],["svenska","sv"],["Tagalog","tl"],["ภาษาไทย","th"],["Türkçe","tr"],["Українська","uk"],["tiếng việt (㗂越)","vi"]],b={},c=0;c<a.length;c++){var d=a[c],e=d[1];if(e.toLowerCase()!==e)throw new Error("lowercase lang code "+e);var f=d[0];b[e]=f}return b}function d(a){for(var b=0,c=e();b<c.length;b++){var d=c[b],f=d.split("-")[0].toLowerCase();if(a[f])return f}return a.en?"en":Object.keys(a)[0]}function e(){var a=[],b=window.navigator,c=["language","browserLanguage","systemLanguage","userLanguage"];if(b.languages)for(var d=0,e=b.languages;d<e.length;d++){var f=e[d];f&&f.length&&a.push(f)}for(var g=b,h=0;h<c.length;h++){var i=c[h],j=g[i];j&&j.length&&a.push(j)}return a}var f=null;a.getSupportedLanguages=b,a.getLanguageCodeToName=c,a.getBestLanguage=d}(p=a.i18nCommon||(a.i18nCommon={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){function b(a){if(!a)throw new Error("check failed:"+angular.toJson(arguments,!0));return a}function c(a){return null===a||void 0===a}function d(a){if(c(a))throw new Error("checkNotNull failed: "+angular.toJson(arguments,!0));return a}function e(b,c){a.log.info("Fetching img: ",b);var d={method:"GET",url:b,responseType:"arraybuffer"};a.$http(d).then(function(b){var d=b.data;a.log.info("Got back img of size ",Math.floor(d.byteLength/1e3),"KB"),c(d)},function(d){a.log.error("Failed loading imgUrl: ",b," response: ",d),c(null)})}a.check=b,a.isMissing=c,a.checkNotNull=d,a.loadImage=e}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(b){function c(){return a.gamesService.getGameId()}function d(a){return a&&a.length>25?a.substring(0,20)+"…":a}function e(){if(!window.localStorage)return!1;try{localStorage.setItem("testLocalStorage","someTestValue"),localStorage.removeItem("testLocalStorage")}catch(a){return!1}return!0}function f(){if(!b.hasMyStorage)return[];try{for(var a=Object.keys(localStorage),d=[],e=c(),f=0;f<a.length;f++){var g=a[f];0===g.indexOf(e)&&d.push(g.substring(e.length))}return d}catch(h){}return[]}function g(d){if(b.hasMyStorage){a.log.info("myStorage.removeItem('",d,"')");try{localStorage.removeItem(c()+d)}catch(e){}}}function h(e){if(!b.hasMyStorage)return null;try{var f=localStorage.getItem(c()+e);return a.log.info("myStorage.getItem('",e,"') returned ",d(f)),f?angular.fromJson(f):null}catch(g){}return null}function i(e,f){if(!f)throw new Error("Doesn't make sense to store null in myStorage!");if(b.hasMyStorage){var g=angular.toJson(f);a.log.info("myStorage.setItem('",e,"',",d(g),")");try{localStorage.setItem(c()+e,g)}catch(h){}}}function j(a){if(!b.hasMyStorage)return null;try{return localStorage.getItem(a)}catch(c){}return null}function k(a,c){if(!b.hasMyStorage)return null;try{localStorage.setItem(a,c)}catch(d){}}b.hasMyStorage=e(),a.log.alwaysLog("myStorage.hasMyStorage=",b.hasMyStorage),b.hasMyStorage||a.sendAnalyticsEvent("LocalStorage is OFF",""),b.getKeys=f,b.removeItem=g,b.getItem=h,b.setItem=i,b.getItemDirectlyWithoutPrefixing=j,b.setItemDirectlyWithoutPrefixing=k}(b=a.myStorage||(a.myStorage={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(b){function c(b){if(!a.myStorage.hasMyStorage||!b||!g(b)||0===b.indexOf("data:image/"))return b;var c=a.myStorage.getItemDirectlyWithoutPrefixing(n+b);return c?c:m[b]?b:(m[b]=!0,a.log.log("Caching img: ",b),k(b),b)}function d(b){a.$http.get("http://gae-image-proxy.appspot.com/?url="+encodeURIComponent(b)).then(function(c){var d=c.data;d&&d.data.length>0?(a.log.info("Success loading from gae-image-proxy image of size=",d.data.length),l(b,d.data)):a.log.error("Error (in success callback!) loading from gae-image-proxy: ",c)},function(b){a.log.error("Error loading from gae-image-proxy: ",b)})}function e(a){return a.indexOf(r)>0}function f(a){return e(a)?"jpg":a.substring(a.length-3)}function g(a){if(e(a))return!0;if(a.length<=4)return!1;var b=a.substring(a.length-4);return".png"===b||".jpg"===b||".gif"===b}function h(){if(!a.myStorage.hasMyStorage)throw new Error("Internal err: checked hasMyStorage before");for(var b=0,c=0;c<localStorage.length;c++){var d=localStorage.key(c);0===d.indexOf(n)&&b++}if(!(200>b)){a.log.warn("Clearing up imgCache because we have more than 200 imgs in the cache!");for(var c=0;c<localStorage.length;c++){var d=localStorage.key(c);0===d.indexOf(n)&&localStorage.removeItem(d)}}}function i(){try{return new Blob,!0}catch(b){a.log.warn("Browser is old and doesn't support Blob, so trying BlobBuilder: ",b);var c=window;if(c.BlobBuilder=c.BlobBuilder||c.WebKitBlobBuilder||c.MozBlobBuilder||c.MSBlobBuilder,"TypeError"==b.name&&c.BlobBuilder){new c.BlobBuilder;return!0}}return!1}function j(b,c){var d="image/"+c;try{return new Blob([b],{type:d})}catch(e){a.log.warn("Browser is old and doesn't support Blob, so trying BlobBuilder: ",e);var f=window;if(f.BlobBuilder=f.BlobBuilder||f.WebKitBlobBuilder||f.MozBlobBuilder||f.MSBlobBuilder,"TypeError"==e.name&&f.BlobBuilder){var g=new f.BlobBuilder;return g.append(b),g.getBlob(d)}}return null}function k(b){return!q||p&&e(b)?void d(b):void a.loadImage(b,function(c){if(!c)return a.log.error("Illegal imgUrl or failed loading imgUrl (trying proxy now): "+b),void d(b);var e=new FileReader,g=c.byteLength;if(a.log.info("Loaded imgUrl: ",b,g),g>1e5)return void a.log.error("Img too big for cache: "+b);var h=j(c,f(b));return h?(e.onload=function(a){var c=e.result;l(b,c)},void e.readAsDataURL(h)):(a.log.warn("Browser doesn't support Blob nor BlobBuilder, so img caching is disabled"),void d(b))})}function l(b,c){try{h(),a.myStorage.setItemDirectlyWithoutPrefixing(n+b,c)}catch(d){a.log.error("Storage failed: "+d)}}var m={},n="imgCache:";b.cache=c;var o=navigator.userAgent.toLowerCase(),p=o.indexOf("iphone")>-1||o.indexOf("ipod")>-1||o.indexOf("ipad")>-1,q=function(){try{return new FileReader,i()}catch(a){}return!1}(),r="/picture?square=square"}(b=a.imgCache||(a.imgCache={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(b){function c(a){M=a}function d(a){L=a}function e(a){G=a}function f(a){F=a}function g(){y||k("You must call setGame before any other method."),z={},A=null,B={},C=null,D=[],E=0,I=0,J=null,H=0}function h(a){if(Object&&Object.keys)return Object.keys(a);var b=[];for(var c in a)b.push(c);return b}function i(a){return angular.copy(a)}function j(a){return void 0===a||null===a}function k(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];a.log.error("Throwing an error with these arguments=",b);var d=b.join(", ");throw new Error(d)}function l(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];j(e.set)||j(e.set.visibleToPlayerIndexes)||-1!==e.set.visibleToPlayerIndexes.indexOf(a)?c.push(e):c.push({set:{key:e.set.key,value:null,visibleToPlayerIndexes:e.set.visibleToPlayerIndexes}})}return c}function m(a,b,c){if(null===b)return null;for(var d={},e=h(b),f=0;f<e.length;f++){var g=e[f],i=c[g],k=null;(j(i)||i.indexOf(a)>-1)&&(k=b[g]),d[g]=k}return d}function n(a){for(var b=a.slice(0),c=[];b.length>=1;){var d=o(0,b.length),e=b.splice(d,1)[0];c.push(e)}return c}function o(a,b){if(j(a)||j(b)||a>=b)throw new Error("In randomFromTo(from,to), you must have from<to, but from="+a+" to="+b);return Math.floor(Math.random()*(b-a)+a)}function p(b){var c,d;if(j(b.set))if(j(b.setTurn))if(j(b.setRandomInteger))if(j(b.setVisibility))if(j(b["delete"]))if(j(b.shuffle))if(j(b.endMatch))k("Illegal operation, it must contain either set, setRandomInteger, setVisibility, delete, shuffle, or endMatch: "+angular.toJson(b,!0));else{var e=b.endMatch;K++;var f=e.endMatchScores;(j(f)||f.length!==F.length)&&k("Field scores in EndMatch operation must be an array of the same length as the number of players. operation="+angular.toJson(b,!0)),J=f,"onlyAIs"===L&&a.$timeout(function(){g()},1e3)}else{var h=b.shuffle,l=h.keys;(j(l)||0===l.length)&&k("Field keys in Shuffle operation must be a non empty array. operation="+angular.toJson(b,!0));for(var m=n(l),p=i(z),q=i(B),r=0;r<m.length;r++){var s=l[r],t=m[r];z[t]=p[s],B[t]=q[s]}}else{var u=b["delete"];c=u.key,j(c)&&k("Field key in Delete operation must be non null. operation="+angular.toJson(b,!0)),delete z[c],delete B[c]}else{var v=b.setVisibility;c=v.key,d=v.visibleToPlayerIndexes,j(c)&&k("Fields key in SetVisibility operation must be non null. operation="+angular.toJson(b,!0)),d?B[c]=d:delete B[c]}else{var w=b.setRandomInteger;c=w.key;var x=w.from,y=w.to;(j(c)||j(x)||j(y))&&k("Fields key, from, and to, in SetRandomInteger operation must be non null. operation="+angular.toJson(b,!0));var A=o(x,y);z[c]=A,delete B[c]}else{var C=b.setTurn;I=C.turnIndex,K++}else{var D=b.set;c=D.key,d=D.visibleToPlayerIndexes;var E=D.value;(j(c)||j(E))&&k("Fields key and value in Set operation must be non null. operation="+angular.toJson(b,!0)),z[c]=E,d?B[c]=d:delete B[c]}}function q(){return"playWhite"===L?0:"playBlack"===L?1:"playViewer"===L?-2:"playAgainstTheComputer"===L||"onlyAIs"===L||"passAndPlay"===L?I:Number(L)}function r(){return{turnIndexBeforeMove:E,turnIndex:I,endMatchScores:J,moveNumber:H,randomSeed:G,lastMove:D,lastState:A,currentState:z,lastVisibleTo:C,currentVisibleTo:B}}function s(a){E=a.turnIndexBeforeMove,I=a.turnIndex,J=a.endMatchScores,H=a.moveNumber?a.moveNumber:0,G=a.randomSeed,D=a.lastMove,A=a.lastState,z=a.currentState,C=a.lastVisibleTo,B=a.currentVisibleTo}function t(){var a=q(),b=l(a,D),c=m(a,A,C),d=m(a,z,B),e={move:b,turnIndexBeforeMove:E,turnIndexAfterMove:I,stateBeforeMove:c,stateAfterMove:d,numberOfPlayers:F.length,playersInfo:F,yourPlayerIndex:a,playMode:L,moveNumber:H,randomSeed:G,endMatchScores:J};angular.equals(N,e)||(N=e,D.length>0&&y.isMoveOk({move:b,turnIndexBeforeMove:E,turnIndexAfterMove:I,stateBeforeMove:c,stateAfterMove:d,numberOfPlayers:F.length})!==!0&&k("You declared a hacker for a legal move! move="+b),y.updateUI(e))}function u(){0===M?t():a.$timeout(function(){t()},M)}function v(a){y||k("You must call setGame before any other method."),-1===I&&k("You cannot send a move after the game ended!"),q()!==I&&k("Expected a move from turnIndex="+I+" but got the move from index="+q()),A=i(z),C=i(B),E=I,I=-1,D=a,H++,G&&Math.seedrandom&&Math.seedrandom(G+H),K=0;for(var b=0;b<a.length;b++){var c=a[b];p(c)}1!==K&&k("We must have either SetTurn or EndMatch, but not both: setTurnOrEndMatchCount="+K),I>=-1&&I<F.length||k("turnIndex must be between -1 and "+F.length+", but it was "+I+"."),u()}function w(a){void 0!==y&&k("You can call setGame only once"),y=a}function x(){return J}var y,z,A,B,C,D,E,F,G,H,I=0,J=null,K=0,L="passAndPlay",M=10;
b.setSimulateServerDelayMilliseconds=c,b.setPlayMode=d,b.setRandomSeed=e,b.setPlayers=f,b.initNewMatch=g,b.randomFromTo=o,b.getMatchState=r,b.setMatchState=s;var N=null;b.sendUpdateUi=u,b.makeMove=v,b.setGame=w,b.getEndMatchScores=x}(b=a.stateService||(a.stateService={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(b){function c(){var b=a.gamesService.getGame();if(!b)throw new Error("Call getSupportedLanguages only after setting game!");return a.i18nCommon.getSupportedLanguages(b.gameFields)}function d(a,b,c){return i(a,b,c)}function e(){return a.i18nCommon.getLanguageCodeToName()}function f(b){a.log.log("i18n.setLanguage:",b);var c=a.gamesService.getGame();if(!c)return void a.log.error("Not setting lanuage because game is null");var d=c.gameFields.languageToLocalizedGameFields[b];return d?(a.Model.currentLanguage=b,i.setLanguage(b),void a.messageSender.sendToGame({setLanguage:{language:b,codeToL10N:d.gameL10n}})):void a.log.error("Not setting lanuage because it's not supported by the game")}function g(b){var c=a.serverApi.myPlayerInfo.language;if(a.log.log("i18n.changeLanguage to:",b," myPlayerInfo.language=",c),c!==b){f(b);var d={displayName:null,userName:null,avatarImageUrl:null,email:null,password:null,blockedPlayerIds:null,language:i.getLanguage()};a.serverApi.updatePlayer(d,function(a){})}}function h(){if("en"===a.Model.currentLanguage){var b=a.i18nCommon.getBestLanguage(a.gamesService.getGame().gameFields.languageToLocalizedGameFields);a.log.log("i18n.findBestLanguage:",b),f(b)}}b.getSupportedLanguages=c;var i=a.translate;b.translate=d,b.getLanguageCodeToName=e,b.setLanguage=f,b.changeLanguage=g,b.findBestLanguage=h}(b=a.i18n||(a.i18n={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b=function(){function b(){this.name="",this.init=a.wrapWithLogApi("init",this._init),this.show=a.wrapWithLogApi("show",this._show),this.hide=a.wrapWithLogApi("hide",this._hide),this.backdrop=a.wrapWithLogApi("backdrop",this._backdrop)}return b.prototype._init=function(a){this.name=a},b.prototype.isShowing=function(){return a.myApp.isModalShowing(this.name)},b.prototype._show=function(){return a.myApp.showModal(this.name)},b.prototype._hide=function(){return a.myApp.hideModal(this.name)},b.prototype._backdrop=function(a){a.target===a.currentTarget&&(a.preventDefault(),a.stopPropagation(),this.hide())},b}();a.ModalCtrl=b,angular.module("myApp").config(["$routeProvider",function(a){a.when("/main",{templateUrl:"html-templates/mainPage.html",controller:""}).when("/playGame/:matchId",{templateUrl:"html-templates/playPage.html",controller:"PlayGameCtrl"}).when("/inviteFriends",{templateUrl:"html-templates/inviteFriendsPage.html",controller:""}).otherwise({redirectTo:"/main"})}]).controller("ModalCtrl",b).controller("PlayGameCtrl",["$routeParams",function(b){var c=b.matchId;a.log.info("PlayGameCtrl matchId=",c);var d=a.myApp.getCurrentMatch();return d&&d.matchId==c?void a.log.info("PlayGameCtrl: already playing in that match, so no point of sending another UpdateUI"):void a.myApp.loadMatchId(c)}])}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b,c=function(){function c(a,b){this.fbId=a,this.displayName=b}return c.prototype.getDisplayName=function(){return this.displayName},c.prototype.getFbId=function(){return this.fbId},c.prototype.getAvatarImage=function(){return a.imgCache.cache(b.getAvatarUrl(this.fbId))},c}();!function(b){function d(){return v}function e(){v=!v,a.Model.facebookFriendsFilter=""}function f(){return x}function g(){return a.inPhonegap}function h(){a.check(a.serverApi.myPlayerInfo);var b=a.myStorage.getItem("fbFriends");if(b){x=[];for(var d=0;d<b.length;d++){var e=b[d];x.push(new c(e.fbId,e.displayName))}i()}u(),a.inPhonegap&&p()}function i(){x.sort(function(a,b){return a.displayName.localeCompare(b.displayName)})}function j(){return void 0!==a.serverApi.myPlayerInfo.uniques[a.IUniqueType.F]}function k(a){return"http://graph.facebook.com/"+a+"/picture?square=square"}function l(b){a.log.info("startMatchWith FB friends:",b);for(var c=[],d=0;d<b.length;d++){var e=b[d],f=e.getFbId(),g=e.getDisplayName(),h=k(f),i=new a.Player({avatarImageUrl:h,displayName:g});i.playerToInvite={avatarImageUrl:h,displayName:g,unique:f,uniqueType:a.IUniqueType.F},c.push(i)}a.myApp.startMatchWith(c)}function m(b){a.$rootScope.$apply(function(){n(b)})}function n(b){if(a.log.info("FB statusChangeCallback: response=",b),"connected"===b.status){if(a.myApp.hideModal("myInfoModal"),w=!1,!b.authResponse||!b.authResponse.userID||!b.authResponse.accessToken)return;var c=b.authResponse.userID,d=b.authResponse.accessToken;t(d),a.serverApi.myPlayerInfo.uniques[a.IUniqueType.F]!==c?a.serverApi.sendMessages([{socialLogin:{accessToken:d,uniqueType:a.IUniqueType.F,gameId:a.gamesService.getGameId()}}],function(a){}):s(d,"/me","id,name",function(b){a.log.info("Got FB /me response:",b);var c=b.data,d=a.serverApi.myPlayerInfo.avatarImageUrl,e=d;c&&c.id&&(e=k(c.id));var f=a.serverApi.myPlayerInfo.displayName,g=f;c&&c.name&&(g=c.name),(d!==e||f!==g)&&(a.log.info("FB displayName or avatarImageUrl changed: ",d,"->",e,f,"->",g),a.serverApi.updatePlayer({avatarImageUrl:e,displayName:g,language:null,email:null,password:null,userName:null,blockedPlayerIds:null},function(a){}))},function(b){a.log.error("Got FB error: ",b)})}else w=!j()}function o(b,c){a.phoneGapService.sendMessage({type:b,appId:a.gamesService.gameFbAppId(),permissions:c.permissions})}function p(){a.log.info("FB checkLoginStatus"),a.inPhonegap?o(0,{}):FB.getLoginStatus(function(a){m(a)})}function q(){if(w){a.myApp.hideModal("myInfoModal");var b=["email","user_friends"];a.inPhonegap?o(1,{permissions:b}):FB.login(function(a){m(a)},{scope:b.join()})}}function r(){return w}function s(b,c,d,e,f){a.$http.get("https://graph.facebook.com/v2.4"+c+"?access_token="+b+"&fields="+encodeURIComponent(d)+"&limit=1000&method=get&pretty=0").then(e,f)}function t(b){y||(y=!0,a.log.info("Loading FB friends using access_token=",b),s(b,"/me/friends","id,name",function(b){a.log.info("Got FB friends response:",b);var d=b.data;if(d&&d.data.length>0){var e=d.data;x=[];for(var f=0;f<e.length;f++){var g=e[f];x.push(new c(g.id,g.name))}i(),a.myStorage.setItem("fbFriends",x)}},function(b){a.log.error("Got FB error: ",b),0===x.length&&a.myApp.showNotificationForTranslationId("IN_APP_NOTIFICATION_GOT_FB_ERROR")}))}function u(){if(!a.serverApi.myPlayerInfo)throw new Error("Call FB init only after setting serverApi.myPlayerInfo");a.inPhonegap||(window.fbAsyncInit=function(){a.$rootScope.$apply(function(){var b={appId:a.gamesService.gameFbAppId(),cookie:!0,xfbml:!0,version:"v2.4"};a.log.info("FB web: Calling FB.init with: ",b),FB.init(b),p()})},a.$timeout(function(){a.createScriptWithCrossorigin("facebook-jssdk","http://connect.facebook.net/en_US/sdk.js")},0))}var v=!1;b.showNameFilter=d,b.toggleNameFilter=a.wrapWithLogApi("toggleNameFilter",e),b._toggleNameFilter=e;var w=!1,x=[];b.friends=f,b.isInPhonegap=g,b.init=h,b.isLoggedIn=j,b.getAvatarUrl=k,b.startMatchWith=a.wrapWithLogApi("startMatchWith",l),b._startMatchWith=l,b.statusChangeCallback=n,b.login=a.wrapWithLogApi("login",q),b._login=q,b.showLoginButton=r;var y=!1}(b=a.facebookService||(a.facebookService={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(b){function c(){return s}function d(b,d){a.serverApi.initMyPlayerInfo(b),a.facebookService.init(),a.phoneGapService.init(),d.push({getPlayerMatches:{updatedTimestampMillisAtLeast:"0"}}),d.push({getGameInviteRequest:{gameId:c()}}),a.facebookService.isInPhonegap()||a.urlParams.isProtractor||(a.createScriptWithCrossorigin("appengineChannelapi","http://multiplayer-gaming.appspot.com/_ah/channel/jsapi"),d.push({createChannelApiToken:{}}))}function e(){if(a.log.info("loadGameAndMyPlayerInfo"),g(),!a.isGameDeveloperSite()){var e=a.myStorage.getItem("game"),h=a.myStorage.getItem("myPlayerInfo");(e&&e.gameId!==s||h&&h.gameId!==s)&&(a.log.error("Found wrong gameId in storage! gameInStorage=",e," myPlayerInfo=",h),localStorage.clear(),h=null,e=null);var i=[{getGames:{gameIds:[c()],gameDeveloperId:null,lowercaseGameName:null,withoutIosKeystores:!0}}],j=!e||!h;if(j){for(var k=a.myStorage.getKeys(),l=0;l<k.length;l++){var m=k[l];a.myStorage.removeItem(m)}var n="Guest-"+Math.floor(1e3*Math.originalRandom()),o=b.BASE_URL+"imgs/avatar"+Math.floor(50*Math.originalRandom())+".gif",p={registerPlayer:{displayName:n,avatarImageUrl:o,userName:null,email:null,password:null,gameId:c(),language:a.translate.getLanguage()}};i.push(p)}else f(e),d(h,i),a.myApp.finishedLoading({wasEmptyStorage:!1});a.serverApi.sendMessages(i,function(b){var c=b[0].error;if(c)return a.log.error("Wrong gameIds: "+angular.toJson(b[0])),void a.myApp.finishedLoading({error:c,wasEmptyStorage:!0});if(e=b[0].games[0],a.myStorage.setItem("game",e),f(e),j){h=b[1].playerInfo;var g=[];d(h,g),a.myApp.finishedLoading({wasEmptyStorage:!0}),a.serverApi.sendMessages(g,function(a){})}})}}function f(b){var c=!r;r=b,c&&(q(),a.i18n.findBestLanguage())}function g(){var a=window;a.HTMLInspector&&setInterval(function(){a.HTMLInspector.inspect({excludeRules:["unused-classes","script-placement","validate-element-location","validate-attributes"],excludeElements:["ng-include"],excludeSubTrees:["#fb-root"]})},1e3)}function h(){var b=r.gameFields.languageToLocalizedGameFields,c=a.translate.getLanguage();return b[c]?b[c]:b.en}function i(){return r.gameFields.minPlayersNum-1}function j(){return r.gameFields.maxPlayersNum-1}function k(){return r.gameFields.autoMatchPlayersNum}function l(){return h().playerColors}function m(){return h().gameName}function n(){return r.gameDeveloperEmail}function o(){return r}function p(){return r.gameFields.facebookAppId||"164855673622766"}function q(){if(t)throw new Error("Can call setGameIframeUrl at most once!");t=!0,b.gameIframeContainerHtml=a.$sce.trustAsHtml('<iframe id="game_iframe" class="nomargins" src="'+r.gameFields.gameUrl+'" seamless="seamless"></iframe>')}var r,s=a.urlParams.onlyGameId?a.urlParams.onlyGameId:"5125637257822208-1";b.getGameId=c,b.BASE_URL="http://yoav-zibin.github.io/default-theme/app/",b.loadGameAndMyPlayerInfo=e,b.getLocalizedGameFields=h,b.minOpponents=i,b.maxOpponents=j,b.autoMatchPlayersNum=k,b.getPlayers=l,b.gameName=m,b.gameEmail=n,b.getGame=o,b.gameFbAppId=p,b.gameIframeContainerHtml="";var t=!1}(b=a.gamesService||(a.gamesService={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b=function(){function b(a){this.displayName=a.displayName,this.avatarImageUrl=a.avatarImageUrl,this.playerId=a.playerId;var b=a;this.playerToInvite=b.playerToInvite}return b.prototype.getDisplayName=function(){return this.displayName},b.prototype.getPlayerId=function(){return this.playerId},b.prototype.isMe=function(){return this.playerId===a.serverApi.myPlayerInfo.playerId},b.prototype.isUnknown=function(){return 0===this.playerId.indexOf(b.unknownPlayerIdPrefix)},b.prototype.isSinglePlayer=function(){return 0===this.playerId.indexOf(b.singlePlayerIdPrefix)},b.prototype.isComputer=function(){return""===this.playerId},b.prototype.getAvatarImage=function(){return a.imgCache.cache(this.avatarImageUrl)},b.singlePlayerIdPrefix="Y",b.unknownPlayerIdPrefix="X",b}();a.Player=b;var c=function(){function c(b,c){this.loadNextMatchOrMainPage=a.wrapWithLogApi("loadNextMatchOrMainPage",this._loadNextMatchOrMainPage),this.dismissAndLoadNextMatchOrMainPage=a.wrapWithLogApi("dismissAndLoadNextMatchOrMainPage",this._dismissAndLoadNextMatchOrMainPage),this.dismissAndRematch=a.wrapWithLogApi("dismissAndRematch",this._dismissAndRematch),this.startNewMatch=a.wrapWithLogApi("startNewMatch",this._startNewMatch),this.dismiss=a.wrapWithLogApi("dismiss",this._dismiss),this.load=a.wrapWithLogApi("load",this._load),this.matchId=b,this.fillMissingPlayersInfo(c),this.checkMatch(),this.createdTimestampMillis=String((new Date).getTime()),this.updatedTimestampMillis=this.createdTimestampMillis,this.isReservedAutoMatch=!1,this.isUnpersistedOnServer=!0}return c.createAutoMatch=function(){return c.createSpecialMatch(c.createMultiplayerMatchId(),c.getNewAutoMatchPlayersInfo())},c.createStartMatchAgainstOpponents=function(b){var d=[a.serverApi.getMyPlayerInfoAsPlayer()].concat(b);if(a.gamesService.minOpponents()!==b.length){for(var e=a.gamesService.autoMatchPlayersNum(),f=d.length;e>f;f++)d.push(null);a.check(d.length==e)}return c.createSpecialMatch(c.createMultiplayerMatchId(),d)},c.createSinglePlayerMatch=function(a){return c.createSpecialMatch(a,c.getSinglePlayerPlayersInfo(a))},c.createSpecialMatch=function(a,b){return new c(a,b)},c.createFromStorage=function(a){var b=new c(a.matchId,a.playersInfo);return b.state=a.state,b.endMatchReason=a.endMatchReason,b.createdTimestampMillis=a.createdTimestampMillis,b.updatedTimestampMillis=a.updatedTimestampMillis,b.isReservedAutoMatch=a.isReservedAutoMatch,b.isUnpersistedOnServer=a.isUnpersistedOnServer,b},c.createFromMatchInfo=function(b){var d=new c(b.matchId,b.playersInfo),e=a.serverApi.unzipState(b.state);d.state=e,d.endMatchReason=b.endMatchReason,d.createdTimestampMillis=b.createdTimestampMillis,d.updatedTimestampMillis=b.updatedTimestampMillis,d.isReservedAutoMatch=b.isReservedAutoMatch,d.isUnpersistedOnServer=!1;var f=b.endMatchScores;return e.endMatchScores=f,f&&(e.turnIndex=-1),d},c.prototype.getMatchId=function(){return this.matchId},c.prototype.createdTime=function(){return Number(this.createdTimestampMillis)},c.prototype.updatedTime=function(){return Number(this.updatedTimestampMillis)},c.prototype.getEndMatchReason=function(){return this.endMatchReason},c.prototype.isSinglePlayer=function(){return"practice"===this.matchId||"passAndPlay"===this.matchId},c.prototype.isOver=function(){return Boolean(this.endMatchReason||this.state&&this.state.endMatchScores)},c.prototype.checkMatch=function(){var b=this.playersInfo;if(!b)throw new Error("Missing match.playersInfo in "+angular.toJson(this));var c=b.length;if(2>c)throw new Error("playersInfo must have at least 2 players: "+angular.toJson(this));var d=1+a.gamesService.minOpponents(),e=1+a.gamesService.maxOpponents();if(d>c||c>e)throw new Error("playersInfo must be between "+d+"-"+e+": "+angular.toJson(this))},c.prototype.getTurnIndex=function(){return this.isOver()?-1:this.state?this.state.turnIndex:0},c.prototype.getTurnIndexBeforeMove=function(){return this.state?this.state.turnIndexBeforeMove:0},c.prototype.isTurnOf=function(a){var b=this.playersInfo[this.getTurnIndex()];return b&&b.playerId==a.playerId},c.prototype.isYourTurn=function(){var a=this.getTurnIndex();return!this.isOver()&&-1!==a&&a===this.getYourPlayerIndex()},c.prototype.getYourPlayerIndex=function(){var b=this.playersInfo;if(this.isSinglePlayer())return this.getTurnIndex();for(var c=0;c<b.length;c++)if(b[c].isMe())return c;throw localStorage.clear(),new Error("Couldn't find my playerId in playersInfo="+angular.toJson(this)+" me="+angular.toJson(a.serverApi.myPlayerInfo))},c.prototype._loadNextMatchOrMainPage=function(){var b=this.getNextMatch();b?b.load():a.main.changePage("/main")},c.prototype._dismissAndLoadNextMatchOrMainPage=function(){var b=this.getNextMatch();this.dismiss(),b?b.load():a.main.changePage("/main")},c.prototype._dismissAndRematch=function(){this.dismiss(),this.startNewMatch()},c.prototype.getNextMatch=function(b){b||(b=a.myApp.allMultiplayerMatches());for(var c=this.matchId,d=0;d<b.length-1;d++){var e=b[d];if(e.matchId==c)return b[d+1]}return null},c.spliceArrayWithLimit=function(a,b,c){if(0>c)return a.slice(0,b);var d=a.length,e=c>0?c-1:c,f=d-1>c?c+1:c;return f-e!=b-1&&d-1>f&&(f=Math.min(d-1,f+(b-1-(f-e)))),f-e!=b-1&&e>0&&(e=Math.max(0,e-(b-1-(f-e)))),a.splice(e,b)},c.prototype.getPlayers=function(a){if(!a)return this.playersInfo;if(a.excludeSinglePlayer&&this.isSinglePlayer())return[];var b=a.limit;if(!b&&!a.excludeMe)return this.playersInfo;for(var d=[],e=0,f=this.playersInfo;e<f.length;e++){var g=f[e];a.excludeMe&&g.isMe()||d.push(g)}if(!b||d.length<=b)return d;var h=this.getTurnIndex();return c.spliceArrayWithLimit(d,b,h)},c.prototype.findPlayerById=function(a){for(var b=0,c=this.playersInfo;b<c.length;b++){var d=c[b];if(d.playerId==a)return d}return null},c.prototype.getEndMatchScores=function(){return this.state?this.state.endMatchScores:null},c.prototype.getMinScore=function(){return Math.min.apply(null,this.getEndMatchScores())},c.prototype.getMaxScore=function(){return Math.max.apply(null,this.getEndMatchScores())},c.prototype.isTie=function(){var a=this.getEndMatchScores();return a?null===this.getWinnerIndex():!1},c.prototype.getWinnerOrLoserIndex=function(a){var b=this.getEndMatchScores();if(!b)return null;for(var c=a?this.getMaxScore():this.getMinScore(),d=null,e=0;e<b.length;e++)if(b[e]===c){if(null!==d)return null;d=e}return d},c.prototype.getLoserIndex=function(){return this.getWinnerOrLoserIndex(!1)},c.prototype.getWinnerIndex=function(){return this.getWinnerOrLoserIndex(!0)},c.prototype.isMultiplayerWithMyFuckingSelf=function(){if(this.isSinglePlayer())return!1;for(var b=0,c=0,d=this.playersInfo;c<d.length;c++){var e=d[c];e.isMe()&&b++}var f=1!==b;return f&&a.log.error("We're not in the match or we have a multiplayer match with myself",this),f},c.prototype.canRematch=function(){var a=this.playersInfo;if(this.isSinglePlayer())return!1;if(this.isMultiplayerWithMyFuckingSelf())return!1;for(var b=0;b<a.length;b++){var c=a[b];if(c.isUnknown())return!1}return!0},c.prototype.canStartNewMatch=function(){return this.isSinglePlayer()||this.canRematch()},c.prototype._startNewMatch=function(){a.myApp.startNewMatch(this)},c.getSinglePlayerPlayersInfo=function(c){for(var d=a.gamesService.minOpponents(),e=[],f="practice"===c,g=0;d+1>g;g++){var h=f&&g>0?"":b.singlePlayerIdPrefix+g,i=a.gamesService.getPlayers(),j=i?i[g]:null;e.push(new b({displayName:j,avatarImageUrl:null,playerId:h}))}return e},c.createMultiplayerMatchId=function(){var a=String(1+Math.floor(8*Math.originalRandom())),b=String(Math.originalRandom()).substring(2,11),c=String(Math.originalRandom()).substring(2,11);return a+b+c},c.getNewAutoMatchPlayersInfo=function(){for(var b=a.gamesService.autoMatchPlayersNum(),c=[a.serverApi.getMyPlayerInfoAsPlayer()],d=1;b>d;d++)c.push(null);return c},c.prototype.getRematchPlayersInfo=function(){a.check(this.canRematch());for(var b=this.playersInfo,c=[a.serverApi.getMyPlayerInfoAsPlayer()],d=0;d<b.length;d++){var e=b[d];e.isMe()||c.push(e)}return c},c.prototype.fillMissingPlayersInfo=function(d){var e=d.length,f=1+a.gamesService.minOpponents();f>e&&(a.log.error("playersNum=",e," is less than the minimum number."),e=f);var g=a.translate("UNKNOWN_PLAYER_NAME");this.playersInfo=[];for(var h=0;e>h;h++){var i=d[h];i||(i={displayName:null,avatarImageUrl:null,playerId:null}),(null===i.playerId||void 0===i.playerId)&&(i.playerId=b.unknownPlayerIdPrefix+h),i.displayName||(i.displayName=g),i.avatarImageUrl||(i.avatarImageUrl=c.UNKNOWN_AVATAR_IMAGE_URL),this.playersInfo[h]=new b(i)}},c.prototype.getMatchStatusText=function(b){var c=b.showDisplayName,d=this,e=d.endMatchReason,f=d.matchId;if(e)switch(e){case a.IEndMatchReason.DISMISSED:return a.translate("MATCH_STATUS_CANCELED")}var g=d.getEndMatchScores(),h=null;if(g){if(d.isTie())return a.translate("MATCH_STATUS_ENDED_IN_TIE");h=d.getWinnerIndex()}var i=d.getTurnIndex(),j=a.gamesService.getPlayers(),k=c&&j?j[null===h?i:h]:null;if("passAndPlay"===f)return k?null===h?a.translate("MATCH_STATUS_OPPONENT'S_TURN_WITH_NAME",{OPPONENT_NAME:k}):a.translate("MATCH_STATUS_OPPONENT_WON_WITH_NAME",{OPPONENT_NAME:k}):null===h?a.translate("MATCH_STATUS_PASS_AND_PLAY_TURN_OF_PLAYER_NUM",{PLAYER_NUMBER:""+(1+i)}):a.translate("MATCH_STATUS_PASS_AND_PLAY_PLAYER_NUM_WON",{PLAYER_NUMBER:""+(1+h)});var l=a.translate("MATCH_STATUS_YOUR_TURN"),m=a.translate("MATCH_STATUS_YOU_WON");if("practice"===f)return g?0===h?m:a.translate("MATCH_STATUS_COMPUTER_WON"):0===i?l:a.translate("MATCH_STATUS_COMPUTER'S_TURN");var n=d.getYourPlayerIndex();if(0>n)throw new Error("Illegal yourPlayerIndex="+n+" in multiplayer game");if(null===h){var o=d.getDisplayName(c,i);return d.isYourTurn()?l:o?a.translate("MATCH_STATUS_OPPONENT'S_TURN_WITH_NAME",{OPPONENT_NAME:o}):a.translate("MATCH_STATUS_OPPONENT'S_TURN")}var p=d.getDisplayName(c,h);return h===n?m:p?a.translate("MATCH_STATUS_OPPONENT_WON_WITH_NAME",{OPPONENT_NAME:p}):a.translate("MATCH_STATUS_OPPONENT_WON")},c.prototype.getDisplayName=function(a,b){return a&&this.playersInfo&&null!==b&&this.playersInfo[b]?this.playersInfo[b].displayName:void 0},c.prototype._dismiss=function(){this.isSinglePlayer()||a.serverApi.dismissMatch(this)},c.prototype._load=function(){a.myApp.loadMatch(this)},c.prototype.getMatchNotification=function(){if(this.isSinglePlayer()||this.isUnpersistedOnServer)return null;var b=null,c=null,d=this.getYourPlayerIndex();if(this.endMatchReason===a.IEndMatchReason.DISMISSED)b="OPPONENT_QUIT",c=this.getLoserIndex();else if(this.getEndMatchScores()){c=this.getTurnIndexBeforeMove();var e=this.getWinnerIndex();b=null===e?"MATCH_ENDED_TIE":e===d?"MATCH_ENDED_YOU_WON":"MATCH_ENDED_YOU_LOST"}else{if(!this.isYourTurn())return null;c=this.getTurnIndexBeforeMove(),b=this.updatedTimestampMillis===this.createdTimestampMillis?"NEW_MATCH":"YOUR_TURN"}if(a.check(null!==c),a.check(null!==b),c===d)return null;var f="PUSH_NOTIFICATION_"+b+"_NOTIFICATION_TITLE",g="PUSH_NOTIFICATION_"+b+"_NOTIFICATION_BODY",h=this.playersInfo[c],i=h.displayName,j={OPPONENT_NAME:i};return{notificationTitle:a.translate(f,j),notificationBody:a.translate(g,j),notificationOpponent:h}},c.UNKNOWN_AVATAR_IMAGE_URL=a.gamesService.BASE_URL+"imgs/autoMatchAvatar.png",c}();a.Match=c}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(b){function c(b){return i?(a.log.info("After getting gameReady, we will send: ",b),void i.push(b)):void d(b)}function d(b){a.log.info("Platform sent to game: ",b);var c=window.document.getElementById("game_iframe");c.contentWindow.postMessage(b,"*")}function e(a){j=a,f()}function f(){if(j&&h()){var a=j;j=null,a()}}function g(){if(i)for(var a=0;a<i.length;a++){var b=i[a];d(b)}i=null,f()}function h(){return null===i}var i=[],j=null;b.sendToGame=c,b.setCallOnGameReady=e,b.gotGameReady=g,b.didGetGameReady=h}(b=a.messageSender||(a.messageSender={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(b){function d(b){var c=location.hash.substring(1);a.log.info("changePage from "+c+" to "+b),e(),H(),l(),c!==b&&(a.$location.path(b),window.scrollTo(0,0),a.sendAnalyticsEvent("changePage",b))}function e(){ya={}}function f(a){if("/"!==a.charAt(0))throw new Error("page must start with '/', but got page="+a);return 0===location.hash.indexOf("#"+a)}function g(b){if(b&&b.canStartNewMatch()){a.log.info("startNewGame"),G();var c=b.matchId;b.isSinglePlayer()?x(c):y(b)}}function h(){var b=a.serverApi.yourTurnMatches.length+a.serverApi.opponentTurnMatches.length+a.serverApi.endedMatches.length;return 100>b?!1:(a.log.warn("Too many matches! totalMatches=",b),p("IN_APP_NOTIFICATION_TOO_MANY_MATCHES_DISMISS_ENDED_MATCHES",function(){a.serverApi.dismissAllEndedMatches()}),!0)}function i(){var b=ta?a.serverApi.getMatch(ta):null;return void 0===b?null:b}function j(){return a.gamesService.getGameId()}function k(){var b=i();if(!b.isSinglePlayer()){var c=b.state,d=null===c?0:c.turnIndex,e=a.stateService.getMatchState(),f=e.turnIndex;a.log.info("maybeSendMultiplayerMakeMove: turnIndex="+f+" oldTurnIndex="+d),f!==d&&n()}}function l(){va&&va.hide()}function m(b){if(b.matchId==ua)return void a.log.log("Not showing 'MOVE_SENT' in-app notification because it was previously dismissed");ua="";var c=a.serverApi.yourTurnMatches[0];c&&c.matchId==b.matchId&&(c=a.serverApi.yourTurnMatches[1]),l(),va=p(c?"IN_APP_NOTIFICATION_MOVE_SENT_LOAD_NEXT_MATCH":"IN_APP_NOTIFICATION_MOVE_SENT_CREATE_NEW_MATCH",function(){c?c.load():a.main.showModal("newMatchModal")},function(){ua=b.matchId})}function n(){var b=i(),c=b.matchId,d=a.stateService.getMatchState(),e=d.turnIndex,f=d.endMatchScores,g=b.isUnpersistedOnServer;f?e=null:m(b);var h,j=a.serverApi.zipState(d);if(g){for(var k={optionalMatchId:c,state:j,nextPlayerIndex:e,endMatchScores:f,base64PrintScreenUpTo10KB:null,messageToNextPlayer:null,numberOfAutoMatchPlayersExcludingYou:0,otherPlayerInfos:null},l=[],n=0,o=b.getPlayers({excludeMe:!0}),p=0;p<o.length;p++){var q=o[p];!q.playerToInvite&&q.isUnknown()?n++:l.push({playerId:q.playerToInvite?null:q.playerId,playerToInvite:q.playerToInvite?q.playerToInvite:null})}k.otherPlayerInfos=l,k.numberOfAutoMatchPlayersExcludingYou=n,h={newMatch:k}}else h={madeMove:{matchId:c,updatedTimestampMillis:b.updatedTimestampMillis,state:j,nextPlayerIndex:e,endMatchScores:f,base64PrintScreenUpTo10KB:null,messageToNextPlayer:null}};a.serverApi.storeAndSendMessages([h],function(a){})}function o(){return xa}function p(c,d,e){return b.showNotification({title:null,message:a.translate(c),player:null,match:null,onClick:d?d:function(){},onClose:e?e:function(){}})}function q(b){var c=wa++;a.log.info("showNotification: ",b);var d=function(){for(var a=0;a<xa.length;a++)if(xa[a].id==c){xa.splice(a,1);break}b.onClick=null,b.onClose=null},e=function(){b.onClick&&(a.log.info("Clicked on notification: ",b.message),b.onClick(),d())},f=function(){b.onClose&&(a.log.info("Closed notification: ",b.message),b.onClose(),d())};return xa.push({id:c,_title:b.title,_player:b.player,_match:b.match,_message:b.message,title:function(){return b.title},player:function(){return b.player},match:function(){return b.match},message:function(){return b.message},onClick:a.wrapWithLogApi("onClick",e),onClose:a.wrapWithLogApi("onClose",f)}),{hide:d}}function r(b){var c=a.serverApi.getMatch(b);c?s(c):(a.log.info("Didn't find matchId=",b),d("/main"))}function s(b){var c=b.matchId;if(!b.isSinglePlayer()){var e=a.serverApi.getMatch(c);e&&(b=e)}t(c),a.log.info("loadMatch matchId=",c),ta=c,d("/playGame/"+c),w(b),a.serverApi.getMatch(c)||O(b)}function t(a){sa[a]&&(sa[a].hide(),delete sa[a])}function u(a){for(var b=0;b<a.length;b++){var c=a[b];c.matchId===ta&&(w(c),E())||v(c)}}function v(a){var b=a.getMatchNotification();if(b){var c=b.notificationTitle,d=b.notificationBody,e=b.notificationOpponent,f=a.matchId;t(f),sa[f]=q({title:c,message:d,player:e,match:a,onClick:function(){delete sa[f],r(f)},onClose:function(){delete sa[f]}})}}function w(b){b.isYourTurn()&&l();var c=(b.playersInfo.length,b.state);if(c){var d=angular.copy(c);a.stateService.setMatchState(d)}else a.stateService.initNewMatch(),a.stateService.setRandomSeed(""+Math.originalRandom());a.stateService.setPlayers(b.playersInfo);var e=b.matchId;a.stateService.setPlayMode("practice"===e?"playAgainstTheComputer":"passAndPlay"===e?"passAndPlay":b.getYourPlayerIndex()),a.stateService.sendUpdateUi(),N()}function x(b){s(a.Match.createSinglePlayerMatch(b))}function y(a){z(a.getPlayers({excludeMe:!0}))}function z(b){if(!h()){a.log.info("startMatchWith: ",b);var c=a.Match.createStartMatchAgainstOpponents(b);s(c)}}function A(){if(!h()){var b={reserveAutoMatch:{numberOfPlayers:a.gamesService.autoMatchPlayersNum()}};a.serverApi.sendMessages([b],a.serverApi.wrapCallbackWithTimeout(function(b){var c,d=b[0].matches[0];c=d?a.checkNotNull(a.serverApi.getMatch(d.matchId)):a.Match.createAutoMatch(),s(c)},function(){s(a.Match.createAutoMatch())},1e3))}}function B(a){return!!ya[a]}function C(a){ya[a]=!0}function D(a){delete ya[a]}function E(){return f("/playGame/")}function F(){return E()&&a.messageSender.didGetGameReady()}function G(){D("gameOverModal")}function H(){Aa&&(a.$timeout.cancel(Aa),Aa=null)}function I(){i();H(),Aa=a.$timeout(function(){C("gameOverModal")},1e3)}function J(a){if(!ta)throw new Error("updateUI with null currentMatchId");za=a,L({updateUI:a})}function K(a){if(!ta)throw new Error("isMoveOk with null currentMatchId");return L({isMoveOk:a}),!0}function L(b){a.messageSender.sendToGame(b)}function M(a){return angular.toJson(a,!0)}function N(){var b=a.stateService.getEndMatchScores();a.log.info("maybeShowGameOverModal endMatchScores=",b),b&&I()}function O(b){var c=a.stateService.getMatchState();b.state=c,a.serverApi.currentMatchUpdatedClientSide(b)}function P(b){D("feedbackModal");var c=b.trim();c&&(a.bugReport.sendBugReport(j(),"Sent feedback","",c),W({link:null,image:null,message:c,subject:"Feedback/bugs for game "+a.gamesService.gameName(),takePrintscreen:!1,toEmail:a.gamesService.gameEmail()}))}function Q(){return Ca}function R(){C("myInfoModal"),c.newDisplayName=a.serverApi.myPlayerInfo.displayName,c.newUserName=a.serverApi.myPlayerInfo.userName,void 0===c.newUserName&&(c.newUserName=""),Ca=!1}function S(){D("myInfoModal")}function T(){var b=c.newDisplayName==a.serverApi.myPlayerInfo.displayName,d=c.newUserName==a.serverApi.myPlayerInfo.userName;if(b&&d)return void S();var e={displayName:b?null:c.newDisplayName,userName:d?null:c.newUserName,avatarImageUrl:null,email:null,password:null,language:null,blockedPlayerIds:null};a.serverApi.updatePlayer(e,a.serverApi.wrapCallbackWithTimeout(function(b){c.newUserName!=a.serverApi.myPlayerInfo.userName&&c.newUserName?(Ca=!0,c.newUserName+=""+Math.floor(1e3*Math.random())):S()},function(){S()},1e3))}function U(b){return b||a.isMissing(b)}function V(b){var c=a.serverApi.myPlayerInfo.userName;c||(c=a.serverApi.myPlayerInfo.playerId);var d=a.gamesService.getGame().gameFields.lowercaseGameName;d||(d=a.gamesService.getGameId());var e="http://gameinvite.us/?"+encodeURIComponent(c)+"="+encodeURIComponent(d),f=a.gamesService.getLocalizedGameFields().gameImageForSharingUrl,g={PLAYER_NAME:a.serverApi.myPlayerInfo.displayName,GAME_NAME:a.gamesService.gameName()},h=b.translationIdPrefix;h||(h="SHARE_INTENT_GAME_INVITE");var i=a.translate(h+"_MESSAGE",g),j=a.translate(h+"_SUBJECT",g);W({link:U(b.link)?e:null,image:U(b.image)?f:null,message:U(b.message)?i:null,subject:U(b.subject)?j:null,takePrintscreen:U(b.takePrintscreen),toEmail:b.toEmail})}function W(b){if(a.facebookService.isInPhonegap()){var c={type:4,shareOptions:b};b.takePrintscreen?a.$timeout(function(){a.phoneGapService.sendMessage(c)},100):a.phoneGapService.sendMessage(c)}else console.warn("shareStuff: Sharing stuff will only work in the app (using a phoengap plugin). options=",b),b.link&&window.open(b.link)}function X(b){return a.imgCache.cache(b)}function Y(){return a.serverApi.allMultiplayerMatches}function Z(){return a.serverApi.yourTurnMatches}function $(){return a.serverApi.opponentTurnMatches}function _(){return a.serverApi.endedMatches}function aa(){return i()}function ba(){return a.serverApi.getMyPlayerInfoAsPlayer()}function ca(){a.log.alwaysLog("CompilationDate: ",a.compilationDate),a.$rootScope.main=a.main,a.gamesService.loadGameAndMyPlayerInfo()}function da(){return Da}function ea(b){b.error||(Da=!0,a.log.info("Finished loading!"),""!==location.hash&&(a.main.changePage("/main"),a.$location.replace()),b.wasEmptyStorage&&a.main.showMyInfoModal())}function fa(){return Ea}function ga(){Ea=!Ea,a.log.info("toggleTopBar to "+(Ea?"showing":"hiding"))}function ha(){a.main.hideModal("gameOverModal"),(a.main.isInPage("/playGame/practice")||a.main.isInPage("/playGame/passAndPlay"))&&a.main.currentMatch().startNewMatch()}function ia(){var b=a.main.currentMatch();return!b.isSinglePlayer()&&!b.isTie()&&b.isOver()&&b.getWinnerIndex()==b.getYourPlayerIndex()}function ja(){return Fa}function ka(){return Ga}function la(){return Ha}function ma(b,c,d){if(b&&c){Ha=!0;var e={chatMessage:b,matchId:null!=d?d.matchId:null,toPlayerId:c.playerId,toUnique:null,uniqueType:null};a.serverApi.storeAndSendMessages([{sendChat:e}],function(a){})}}function na(a,b){Ha=!1,c.chatMessage="",a.isMe()?R():(C("playerInfoModal"),Fa=a,Ga=b)}function oa(){var b=aa();if(!b)return"";var c=b.getPlayers({excludeMe:!0}).map(function(a){return a.displayName});return a.translate("MATCH_START_REMATCH",{OPPONENTS_NAME:c.join(", ")})}function pa(b){if(b.isMe()||b.isUnknown()||b.isSinglePlayer()||b.isComputer())return void a.log.error("You can only block a multiplayer opponent.");
var c=a.serverApi.myPlayerInfo.blockedPlayerIds,d=b.playerId,e=c.indexOf(d);-1!==e?c.splice(e,1):c.push(d);var f={displayName:null,userName:null,avatarImageUrl:null,email:null,password:null,language:null,blockedPlayerIds:c};a.serverApi.updatePlayer(f,function(a){})}function qa(b){return-1!==a.serverApi.myPlayerInfo.blockedPlayerIds.indexOf(b.playerId)}function ra(){return c}var sa={},ta=null;b.changePage=d,b.isInPage=f,b.startNewMatch=g,b.getCurrentMatch=i;var ua="",va=null,wa=4242,xa=[];b.notifications=o,b.showNotificationForTranslationId=p,b.showNotification=q,b.loadMatchId=r,b.loadMatch=s,b.matchesWereUpdated=u,b.newSinglePlayer=x,b.startMatchWith=z,b.newMultiplayerAutoMatch=A;var ya={};b.isModalShowing=B,b.showModal=C,b.hideModal=D,b.showGameIframe=F;var za,Aa=null;window.addEventListener("message",function(b){var c=window.document.getElementById("game_iframe");c&&c.contentWindow===b.source&&a.$rootScope.$apply(function(){var c=b.data;if(a.log.info("Platform got message:",c),"load"!==c.type||!c.isFrame){if(c.emailJavaScriptError)return void a.bugReport.sendGameException(j(),c.emailJavaScriptError);if(!c.setLanguageResult){if(void 0!==c.isMoveOkResult){if(c.isMoveOkResult===!0)return;return void a.bugReport.sendBugReport(j(),"Got non-true isMoveOk from game",M(c.isMoveOkResult),"")}if(c.gameReady)return a.messageSender.didGetGameReady()?void a.log.warn("Game sent gameReady before (look at the logs)! You can only send gameReady once."):void a.messageSender.gotGameReady();if(!c.makeMove)return void a.bugReport.sendBugReport(j(),"Game sent an unknown message:",M(c),"");if(!ta)return void a.bugReport.sendBugReport(j(),"Game sent makeMove before getting a non-fake UpdateUI",M(c),"");if(c.lastUpdateUI&&!angular.equals(c.lastUpdateUI,za))return void a.log.error("You have an extremely slow phone, and this move belongs to an old updateUI! message="+M(c)+" lastUpdateUI="+M(za));try{a.stateService.makeMove(c.makeMove)}catch(d){return void a.bugReport.sendBugReport(j(),d,"Game sent an illegal makeMove: "+M(c),"")}if(!i())return void a.log.info("Rare, but can happen, e.g., if the match was loaded from myStorage and the list of matches from the server no longer contained that match");k(),O(i()),N()}}})},!1);var Ba={updateUI:J,isMoveOk:K};a.stateService.setSimulateServerDelayMilliseconds(0),a.stateService.setGame(Ba),b.sendFeedback=P;var Ca=!1;b.newUserNameWasTaken=Q,b.showMyInfoModal=R,b.saveMyInfo=T,b.shareInviteLink=V,b.shareStuff=W,b.cacheImage=X,b.allMultiplayerMatches=Y,b.yourTurnMatches=Z,b.opponentTurnMatches=$,b.endedMatches=_,b.currentMatch=aa,b.me=ba,b.initMyApp=ca;var Da=!1;b.isFinishedLoading=da,b.finishedLoading=ea;var Ea=!0;b.shouldShowTopBar=fa,b.toggleTopBar=ga,b.closeGameOverModal=ha,b.didWinMultiplayerMatch=ia;var Fa;b.playerInPlayerInfoModal=ja;var Ga;b.matchInPlayerInfoModal=ka;var Ha=!1;b.didSendChat=la,b.sendChat=ma,b.showPlayerInfoModal=na,b.translateRematch=oa,b.toggleBlocking=pa,b.isBlocking=qa,b.model=ra}(b=a.myApp||(a.myApp={}));var c;!function(a){a.feedbackText="",a.currentLanguage="en",a.newDisplayName=null,a.newUserName=null,a.facebookFriendsFilter="",a.chatMessage=""}(c=a.Model||(a.Model={}));var d={changeLanguage:a.wrapWithLogApi("changeLanguage",a.i18n.changeLanguage),getSupportedLanguages:a.i18n.getSupportedLanguages,translate:a.i18n.translate,setTranslations:a.wrapWithLogApi("setTranslations",a.translate.setTranslations)},e={showLoginButton:a.facebookService.showLoginButton,startMatchWith:a.facebookService.startMatchWith,showNameFilter:a.facebookService.showNameFilter,isLoggedIn:a.facebookService.isLoggedIn,login:a.facebookService.login,friends:a.facebookService.friends,toggleNameFilter:a.facebookService.toggleNameFilter},f=function(){function b(){}return b.prototype.name=function(){return a.gamesService.gameName()},b.prototype.isHidePracticeOption=function(){return a.gamesService.getGame().gameFields.hidePracticeOption},b.prototype.isHidePassAndPlayOption=function(){return a.gamesService.getGame().gameFields.hidePassAndPlayOption},b.prototype.getIframeHtml=function(){return a.gamesService.gameIframeContainerHtml},b}(),g=new f;a.main={fb:function(){return e},l10n:function(){return d},game:function(){return g},model:function(){return c},isFinishedLoading:b.isFinishedLoading,cacheImage:b.cacheImage,yourTurnMatches:b.yourTurnMatches,opponentTurnMatches:b.opponentTurnMatches,endedMatches:b.endedMatches,allMultiplayerMatches:b.allMultiplayerMatches,currentMatch:b.currentMatch,me:b.me,shareInviteLink:a.wrapWithLogApi("shareInviteLink",b.shareInviteLink),shareStuff:a.wrapWithLogApi("shareStuff",b.shareStuff),changePage:a.wrapWithLogApi("changePage",b.changePage),isInPage:b.isInPage,showGameIframe:b.showGameIframe,notifications:b.notifications,newSinglePlayer:a.wrapWithLogApi("newSinglePlayer",b.newSinglePlayer),newMultiplayerAutoMatch:a.wrapWithLogApi("newMultiplayerAutoMatch",b.newMultiplayerAutoMatch),startMatchWith:a.wrapWithLogApi("startMatchWith",b.startMatchWith),shouldShowTopBar:b.shouldShowTopBar,toggleTopBar:a.wrapWithLogApi("toggleTopBar",b.toggleTopBar),isModalShowing:b.isModalShowing,hideModal:a.wrapWithLogApi("hideModal",b.hideModal),showModal:a.wrapWithLogApi("showModal",b.showModal),showPlayerInfoModal:a.wrapWithLogApi("showPlayerInfoModal",b.showPlayerInfoModal),playerInPlayerInfoModal:b.playerInPlayerInfoModal,matchInPlayerInfoModal:b.matchInPlayerInfoModal,didSendChat:b.didSendChat,sendChat:a.wrapWithLogApi("sendChat",b.sendChat),showMyInfoModal:a.wrapWithLogApi("showMyInfoModal",b.showMyInfoModal),saveMyInfo:a.wrapWithLogApi("saveMyInfo",b.saveMyInfo),newUserNameWasTaken:b.newUserNameWasTaken,closeGameOverModal:a.wrapWithLogApi("closeGameOverModal",b.closeGameOverModal),didWinMultiplayerMatch:b.didWinMultiplayerMatch,sendFeedback:a.wrapWithLogApi("sendFeedback",b.sendFeedback),translateRematch:b.translateRematch,toggleBlocking:a.wrapWithLogApi("toggleBlocking",b.toggleBlocking),isBlocking:b.isBlocking}}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){a.inPhonegap=window.self!=window.top||!!a.urlParams.phonegapPlugins;var b;!function(b){function c(b){return a.inPhonegap?void(l?(a.log.log("Queue message to phonegap:",b),l.push(b)):(a.log.log("phoneGapService.sendMessage: ",b),a.urlParams.phonegapPlugins?b.execute||a.$timeout(function(){return a.phonegapCode.gotMessage(b)},0):parent.postMessage(b,"*"))):void a.log.log("NOT sending phoneGap message (not inside phonegap): ",b)}function d(b){a.$rootScope.$apply(function(){f(b)})}function e(){if(!k)throw new Error("Aleady called phoneGapService.init");a.log.log("Processing ",k.length," phonegap msgs we had in the queue");for(var b=0;b<k.length;b++){var d=k[b];g(d)}k=null;var e=l;if(l=null,a.inPhonegap){c({execute:a.codeInjectedIntoPhonegap});for(var f=0;f<e.length;f++){var h=e[f];c(h)}}}function f(b){k?(a.log.log("Queue message from phonegap:",b),k.push(b)):g(b)}function g(b){a.log.log("Process message from phonegap:",b),b.fbLoginStatus?a.facebookService.statusChangeCallback(b.fbLoginStatus):b.registerForPushNotifications?j(b.registerForPushNotifications):b.gotPushNotification?i(b.gotPushNotification):b.phonegapResumed?h():b.hadPhonegapError?a.bugReport.sendBugReport(a.bugReport.IRRELEVANT_GAME_ID,angular.toJson(b.hadPhonegapError,!0),"",""):b.addLog||a.log.warn("Got unknown message from phonegap.")}function h(){var b=[];b.push({getGameInviteRequest:{gameId:a.gamesService.getGameId()}}),b.push({getPlayerMatches:{updatedTimestampMillisAtLeast:"0"}}),a.serverApi.sendMessages(b,function(a){})}function i(b){var c=b.matchId,d=b.updatedTimestampMillis;if(!c||!d)return void a.log.warn("gotPushNotification: Missing matchId or updatedTimestampMillis!");var e=!b.foreground||b.coldstart,f=b.matchInfoJson,g=b.gotChatJson;if(g)return a.log.info("Got a chat msg"),void a.serverApi.gotChat(angular.fromJson(g));if(f){var h=a.Match.createFromMatchInfo(angular.fromJson(f));return a.log.info("gotPushNotification with chat msg or matchInfoJson: shouldLoadMatch=",e," matchInfo=",h),void(e?a.myApp.loadMatch(h):a.serverApi.setMatch(h))}var i=a.serverApi.getMatch(c);if(i&&i.updatedTimestampMillis===d)return a.log.info("gotPushNotification: Already got update, but if it's !foreground then load match"),void(e&&a.myApp.loadMatch(i));var j=!1;i&&e&&(a.log.info("gotPushNotification: Loading match now, and getPlayerMatches if not coldstart"),a.myApp.loadMatch(i),j=!0,b.coldstart)||a.serverApi.sendMessages([{getPlayerMatches:{updatedTimestampMillisAtLeast:"0"}}],function(b){var d=a.serverApi.getMatch(c);return d?void(e&&!j?(a.log.info("gotPushNotification: App wasn't in foreground when notification arrived, so loading the match"),a.myApp.loadMatch(d)):a.log.info("gotPushNotification: App was in foreground when notification arrived, so not loading it")):void a.log.error("gotPushNotification: We got a notification for a match, but the match no longer exist")})}function j(b){a.serverApi.sendMessages([{registerForPushNotifications:b}],function(a){})}a.urlParams.phonegapPlugins||window.addEventListener("message",function(a){if(parent===a.source){var b=a.data;d(b)}},!1);var k=[],l=[];b.sendMessage=c,b.onMessageRecieve=d,b.init=e}(b=a.phoneGapService||(a.phoneGapService={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){var b;!function(b){function c(){return new a.Player({displayName:b.myPlayerInfo.displayName,avatarImageUrl:b.myPlayerInfo.avatarImageUrl,playerId:b.myPlayerInfo.playerId})}function d(c){if(!c)throw new Error("_myPlayerInfo is not set!");if(c.language&&c.language!==a.Model.currentLanguage&&(a.log.info("i18n.setLanguage from updateMyPlayerInfo"),a.i18n.setLanguage(c.language)),!angular.equals(b.myPlayerInfo,c)){if(b.myPlayerInfo){var d=b.myPlayerInfo.playerId,f=c.playerId;d!==f&&e(d,f)}b.myPlayerInfo=c,a.myStorage.setItem("myPlayerInfo",b.myPlayerInfo)}}function e(c,d){a.log.info("updatePlayerId from: ",c," to: ",d);for(var e in b.matchIdToMatch)for(var f=h(e),g=0,i=f.playersInfo;g<i.length;g++){var j=i[g];j.playerId===c&&(j.playerId=d)}a.myStorage.setItem("matchIdToMatch",b.matchIdToMatch)}function f(c,d){b.storeAndSendMessages([{updatePlayer:c}],d),c.language&&(b.myPlayerInfo.language=c.language),c.displayName&&(b.myPlayerInfo.displayName=c.displayName),c.avatarImageUrl&&(b.myPlayerInfo.avatarImageUrl=c.avatarImageUrl),c.email&&(b.myPlayerInfo.email=c.email),c.password&&(b.myPlayerInfo.password=c.password),c.blockedPlayerIds&&(b.myPlayerInfo.blockedPlayerIds=c.blockedPlayerIds),a.myStorage.setItem("myPlayerInfo",b.myPlayerInfo)}function g(c){a.log.info("initMyPlayerInfo:",c),d(c),a.setAnalyticsField("&uid",b.myPlayerInfo.playerId),a.sendAnalyticsEvent("PlayerActivity","Login");var e=a.myStorage.getItem("matchIdToMatch");if(b.matchIdToMatch={},e)for(var f in e){var g=e[f];i(a.Match.createFromStorage(g))}m(),G()}function h(a){return b.matchIdToMatch[a]}function i(c){var d=c.matchId;if(!c.isSinglePlayer()){var e=h(d);if(e&&e.updatedTime()>=c.updatedTime())return a.log.info("Ignoring a match with an older updatedTime"),e}return b.matchIdToMatch[d]=c,c}function j(a){a.length<=1||a.sort(function(a,b){return Number(b.updatedTimestampMillis)-Number(a.updatedTimestampMillis)})}function k(){var a={};for(var c in b.matchIdToMatch){var d=h(c);(d.isSinglePlayer()||d.isUnpersistedOnServer)&&(a[c]=h(c))}return a}function l(){var c=[];for(var d in b.matchIdToMatch){var e=h(d);e.isMultiplayerWithMyFuckingSelf()&&c.push(e)}c.length>0&&(a.log.error("Dismissing matches were I'm playing with myself: ",c),t(c))}function m(){l(),b.yourTurnMatches=[],b.opponentTurnMatches=[],b.endedMatches=[];for(var a in b.matchIdToMatch){var c=h(a);if(!c.isSinglePlayer()&&!c.isReservedAutoMatch){var d=c.isOver()?b.endedMatches:c.isYourTurn()?b.yourTurnMatches:b.opponentTurnMatches;d.push(c)}}j(b.yourTurnMatches),j(b.opponentTurnMatches),j(b.endedMatches),b.allMultiplayerMatches=b.yourTurnMatches.concat(b.opponentTurnMatches).concat(b.endedMatches)}function n(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.Match.createFromMatchInfo(e))}return c}function o(c){a.myStorage.setItem("matchIdToMatch",b.matchIdToMatch),m(),c.length>0&&a.myApp.matchesWereUpdated(c)}function p(a){var b=i(a);b===a&&o([b])}function q(a){for(var c=k(),d=[],e=0;e<a.length;e++){var f=a[e],g=i(f);c[g.matchId]=g,g===f&&d.push(g)}b.matchIdToMatch=c,o(d)}function r(a){i(a),o([])}function s(a){t([a])}function t(a){for(var c=[],d=0;d<a.length;d++){var e=a[d],f=e.matchId;delete b.matchIdToMatch[f],e.isReservedAutoMatch||e.isUnpersistedOnServer||c.push({dismissMatch:{matchId:f}})}o([]),c.length>0&&F(c,function(a){})}function u(){a.log.info("dismissAllEndedMatches"),t(b.endedMatches)}function v(a){return LZString.compressToBase64(angular.toJson(a))}function w(a){return angular.fromJson(LZString.decompressFromBase64(a))}function x(b){if(b&&b.length)for(var c=0;c<b.length;c++){var d=b[c];z(d)}else a.log.error("processServerApiResponses got empty responseArr!")}function y(b){switch(b.errorCode){case a.IApiReason.MATCH_ALREADY_ENDED:case a.IApiReason.MATCH_ALREADY_DISMISSED:case a.IApiReason.GAME_DEVELOPER_EMAIL_EXISTS_PASSWORD_RESENT:return!0;case a.IApiReason.PLAYER_NOT_IN_MATCH:return"madeMove.matchId"==b.fieldCausingError;case a.IApiReason.FIELD_ALREADY_EXIST:return-1!=O.indexOf(b.fieldCausingError);case a.IApiReason.WRONG_VALUE_IN_FIELD:return-1!=N.indexOf(b.fieldCausingError)}return!1}function z(b){if(b.error){if(a.log.info("processServerApiResponses error: ",b),b.errorCode===a.IApiReason.PLAYER_BLOCKED)return void a.myApp.showNotificationForTranslationId("IN_APP_NOTIFICATION_YOU_WERE_BLOCKED");y(b)||a.bugReport.sendBugReport(a.bugReport.IRRELEVANT_GAME_ID,angular.toJson(b,!0),"","")}if(b.channelApiToken&&A(b.channelApiToken),b.getGameInviteResponse&&b.getGameInviteResponse.inviter&&D(new a.Player(b.getGameInviteResponse.inviter)),b.gotChat&&b.gotChat.fromPlayer&&C(b.gotChat),b.playerInfo&&d(b.playerInfo),b.matches){var c=n(b.matches),e=c.length;e>=2?q(c):1===e&&p(c[0])}}function A(b){var c=window;if(!c.goog||!c.goog.appengine||!c.goog.appengine.Channel)return a.log.info("AppEngine channel API not loaded yet, trying again in 2 seconds."),void a.$timeout(function(){a.log.info("Retrying createChannelApi"),A(b)},2e3);a.log.info("Creating channel API");var d=new c.goog.appengine.Channel(b),e=d.open(),f=a.$timeout(function(){a.log.alwaysLog("Closing Channel API because 2 hours passed."),e.close()},72e5);e.onopen=function(){a.log.info("Channel API onopen.")},e.onmessage=function(b){a.log.info("Channel API onmessage:",b),a.$rootScope.$apply(function(){var a=angular.fromJson(b.data);x([a])})},e.onerror=function(b){a.log.info("Channel API onerror:",b)},e.onclose=function(){a.log.info("Channel API onclose."),a.$timeout.cancel(f),B()}}function B(){var a={createChannelApiToken:{}};H([a],function(a){})}function C(b){var c=new a.Player(b.fromPlayer),d=b.chatMessage,e=h(b.matchId);e||(e=null);var f={PLAYER_NAME:c.displayName,GAME_NAME:a.gamesService.gameName()};a.myApp.showNotification({title:a.translate("PUSH_NOTIFICATION_CHAT_MESSAGE_NOTIFICATION_TITLE",f),message:d,player:c,match:e,onClick:function(){e&&e.load()},onClose:function(){}})}function D(b){a.log.info("gotGameInvite from: ",b);var c={PLAYER_NAME:b.displayName,GAME_NAME:a.gamesService.gameName()};a.myApp.showNotification({title:a.translate("IN_APP_NOTIFICATION_GAME_INVITE_TITLE",c),message:a.translate("IN_APP_NOTIFICATION_GAME_INVITE_BODY",c),player:b,match:null,onClick:function(){a.myApp.startMatchWith([b])},onClose:function(){}})}function E(b,c,d){var e=!1;return a.$timeout(function(){e||(e=!0,c())},1e3),function(a){e||(e=!0,b(a))}}function F(b,c){var d=a.myStorage.getItem("nextServerApiId");d||(d=0),d++,a.myStorage.setItem("nextServerApiId",d);var e="serverApiMsgs"+d;a.myStorage.setItem(e,b),H(b,function(b){a.myStorage.removeItem(e),c(b)})}function G(){for(var b=[],c=a.myStorage.getKeys(),d=[],e=0;e<c.length;e++){var f=c[e];0===f.indexOf("serverApiMsgs")&&(d.push(f),b=b.concat(a.myStorage.getItem(f)))}0!==b.length&&H(b,function(b){for(var c=0;c<d.length;c++){var e=d[c];a.myStorage.removeItem(e)}})}function H(c,d){a.log.info("serverApiService.sendMessages: ",c," numberOfMsgsSent=",++R);for(var e=0;e<c.length;e++){var f=c[e],g=0;for(var h in f)if(g++,b.myPlayerInfo){var i=f,j=i[h];j.playerId=b.myPlayerInfo.playerId,j.accessSignature=b.myPlayerInfo.accessSignature}if(1!==g)throw new Error("ServerApi can only handle a single command in every msg, but you have "+g+" commands in "+f)}P.push({msgs:c,callback:d}),I()}function I(){0===Q.length&&P.length>0&&(Q=P,P=[],J())}function J(){for(var b=[],c=0;c<Q.length;c++){var d=Q[c];b=b.concat(d.msgs)}for(var e=[],f=0;f<b.length;f++){var g=b[f];for(var h in g)e.length<5&&e.push(h)}var i=angular.toJson(b);a.log.info("serverApiService sends ajax: ",e),e.sort();var j=e.join(",");M(j,i,K)}function K(b){if(!b)return P=Q.concat(P),Q=[],a.log.warn("ServerApi internet error, doing random exponential backoff with ajaxBackoffDelayInSeconds=",S),S*=2,void setTimeout(I,1e3*S*Math.originalRandom());S=1;try{L(b)}finally{Q=[],I()}}function L(a){var b=Q.reduce(function(a,b){return a+b.msgs.length},0);if(b!=a.length)throw new Error("serverApi didn't respond with the correct number of responses: #messagesInTransit="+b+" #responses="+a.length);for(var c=0;c<Q.length;c++){var d=Q[c],e=d.msgs.length,f=a.slice(0,e);a=a.slice(e),d.callback(f)}}function M(b,c,d){var e=a.log.getCurrentTime();a.appEngine.makeAjaxCallNoRetry(b,c,function(c){if(c){a.log.info("For msgs=",b," serverApiService gets: ",c);var f=a.log.getCurrentTime()-e;a.sendAnalyticsTiming("ServerApiResponse",b,f),x(c),d(c)}else a.log.warn("Failed to reach serverApi."),d(c)})}b.myPlayerInfo=null,b.getMyPlayerInfoAsPlayer=c,b.updatePlayer=f,b.initMyPlayerInfo=g,b.getMatch=h,b.setMatch=p,b.currentMatchUpdatedClientSide=r,b.dismissMatch=s,b.dismissAllEndedMatches=u,b.zipState=v,b.unzipState=w;var N=["bugReportIds","matchId","gameId"],O=["optionalMatchId (my own match)"];b.gotChat=C,b.wrapCallbackWithTimeout=E,b.storeAndSendMessages=F;var P=[],Q=[],R=0;b.sendMessages=H;var S=1}(b=a.serverApi||(a.serverApi={}))}(gamingPlatform||(gamingPlatform={}));var gamingPlatform;!function(a){angular.module("myApp").run(["$location","$rootScope","$timeout","$interval","$sce","$interpolate","$templateCache","$http","$route",function(b,c,d,e,f,g,h,i,j){a.$location=b,a.$rootScope=c,a.$timeout=d,a.$interval=e,a.$sce=f,a.$interpolate=g,a.$templateCache=h,a.$http=i,a.$route=j,a.myApp.initMyApp()}]),Math.originalRandom=Math.random}(gamingPlatform||(gamingPlatform={})),function(){var a={CHAT_SENT:{en:"Chat sent",iw:"צט נשלח",pt:"",zh:"对话发送",el:"",fr:"",hi:"",es:"Mensaje enviado"},FB_FRIENDS_ACTION_INVITE:{en:"Invite",iw:"הזמן",pt:"Convidar",zh:"邀请",el:"Πρόσκληση",fr:"Invitez",hi:"आमंत्रण",es:"Invitar"},FB_FRIENDS_DID_NOT_INSTALL_APP:{en:"We're sorry, but it looks like none of your friends has this app installed.",iw:"החברים שלך לא התקינו את האפליקציה",pt:"Desculpe, mas parece que nenhum dos seus amigos tem esse aplicativo instalado.",zh:"不好意思，你朋友们都没安装这个程序",el:"Δυστυχώς, κανένας από την λίστα φίλων σας, δεν έχει εγκαταστήσει την εφαρμογή.",fr:"Nous sommes désolés , mais il ressemble à aucun de vos amis a cette application installée",hi:"हमें खेद है, लेकिन यह अपने दोस्तों में से कोई तरह लग रहा है स्थापित इस एप्लिकेशन है",es:"Ninguno de tus amigos tiene el app instalado"},FB_FRIENDS_FILTER_CANCEL:{en:"Cancel",iw:"בטל",pt:"Cancelar",zh:"取消",el:"Ακύρωση",fr:"Annuler",hi:"रद्द करना",es:"Cancelar"},FB_FRIENDS_SHARE:{en:"Share",iw:"שתף",pt:"",zh:"分享",el:"",fr:"",hi:"",es:"Compartir"},FB_FRIENDS_TITLE:{en:"Facebook",iw:"חברים",pt:"Amigos",zh:"脸书上的朋友",el:"Φίλοι",fr:"Amis",hi:"दोस्तो",es:"Facebook"},IN_APP_NOTIFICATION_GAME_INVITE_BODY:{en:"{{PLAYER_NAME}} wants to play with you!",iw:"{{PLAYER_NAME}} רוצה לשחק איתך!",pt:"{{PLAYER_NAME}} quer jogar com você!",zh:"{{PLAYER_NAME}}想和你一起玩",el:"",fr:"{{PLAYER_NAME}} veut jouer avec vous!",hi:"{{PLAYER_NAME}} आप के साथ खेलना चाहता है!",es:"{{PLAYER_NAME}} quiere jugar contigo!"},IN_APP_NOTIFICATION_GAME_INVITE_TITLE:{en:"Game invite",iw:"הזמנה למשחק",pt:"Convite",zh:"游戏邀请",el:"",fr:"Jeu Inviter",hi:"खेल आमंत्रण",es:"Invitar a jugar"},IN_APP_NOTIFICATION_GOT_FB_ERROR:{en:"We received an error from Facebook, please try again later.",iw:"היתה שגיאה בפייסבוק. נסה שוב אחר כך",pt:"Nós recebemos um erro do Facebook. Por favor tente novamente mais tarde.",zh:"错误，请重试",el:"Προκλήθηκε σφάλμα από την μεριά του Facebook, παρακαλώ προσπαθήστε αργότερα.",fr:"Nous avons reçu une erreur de Facebook , s'il vous plaît réessayer plus tard .",hi:"हम फेसबुक से एक त्रुटि प्राप्त किया, बाद में पुन: प्रयास करें ।",es:"Recibimos un error de Facebook, intenta otra vez mas tarde"},IN_APP_NOTIFICATION_MOVE_SENT_CREATE_NEW_MATCH:{en:"Move sent, and no more moves to make in any game. Click to create new game.",iw:"מסע נשלח. לחץ כדי להתחיל משחק חדש",pt:"",zh:"最后回合结束，点击开始新的游戏",el:"",fr:"",hi:"",es:"Jugada enviada; no hay jugadas por hacer en otros juegos. Haz click para crear un nuevo juego."},IN_APP_NOTIFICATION_MOVE_SENT_LOAD_NEXT_MATCH:{en:"Move sent. Click to make a move in the next game.",iw:"מסע נשלח. לחץ כדי לעשות מסע במשחק הבא",pt:"",zh:"操作已发送，请在下一场游戏中进行操作",el:"",fr:"",hi:"",es:"Jugada enviada; haz click para hacer una movida en el siguente juego."},IN_APP_NOTIFICATION_TOO_MANY_MATCHES_DISMISS_ENDED_MATCHES:{en:"You have too many games. Click here to quit games that ended.",iw:"יש לך יותר מידי משחקים. לחץ כאן כדי לבטל משחקים שנגמרו כבר",pt:"Você tem muitos jogos em progresso. Clique aqui para sair de partidas encerradas.",zh:"你有太多局，请点这来退出已结束的",el:"Έχετε πολλά ενεργά παιχνίδια. Κάντε κλίκ εδώ για να κλείσετε κάποια από τα παιχνίδια που έχουν τελειώσει.",fr:"Vous avez trop de jeux . Cliquez ici pour arrêter de jeux qui se sont terminées",hi:"आप भी कई खेल है । समाप्त हो गया है कि खेल को छोड़ने के लिए यहां क्लिक करें।",es:"Tienes demasiados juegos abiertos. Haz click para cerrar juegos terminados."},IN_APP_NOTIFICATION_YOU_WERE_BLOCKED:{en:"You were blocked and therefore you can't send chat or start a new match with the blocking player.",iw:"מישהו חסם אותך ואינך יכול לשלוח צט",pt:"",zh:"你被屏蔽了，所以你不能聊天或者匹配屏蔽了的玩家",el:"",fr:"",hi:"",es:"You were blocked and therefore you can't send chat or start a new match with the blocking player."},MAIN_FEEDBACK_AND_BUGS_TITLE:{en:"Feedback",iw:"משוב",pt:"Comentários e erros",zh:"反馈",el:"",fr:"Commentaires et bogues",hi:"आपके सुझाव और कीड़े",es:"Feedback"},MAIN_INVITE_FRIENDS_TITLE:{en:"Facebook friends",iw:"הזמן חבר למשחק",pt:"Convide os seus amigos para jogar",zh:"邀请朋友来玩",el:"Καλέστε τους φίλους σας για ένα παιχνίδι.",fr:"Invitez vos amis pour un jeu",hi:"एक खेल के लिए अपने मित्रों को आमंत्रित करें",es:"Amigos de Facebook"},MAIN_LOG_IN_WITH_FACEBOOK:{en:"Log in with Facebook",iw:"כנס עם פייסבוק",pt:"Entrar com Facebook",zh:"登陆脸书",el:"Συνδεθείτε με λογαριασμό Facebook.",fr:"Se connecter avec Facebook",hi:"फ़ेसबुक लॉगिन करें",es:"Iniciar sesion con Facebook"},MAIN_LOG_OUT_FROM_FACEBOOK:{en:"Log out from Facebook",iw:"צא מפייסבוק",pt:"Sair do Facebook",zh:"退出脸书",el:"Αποσυνδεθείτε από το Facebook.",fr:"Déconnecter de Facebook",hi:"फेसबुक से लॉग आउट करें",es:"Cerrar sesion de Facebook"},MAIN_MATCH_GROUP_ENDED_MATCHES:{en:"Ended Games",iw:"משחקים שנגמרו",pt:"Partidas terminadas",zh:"已结束游戏",el:"Ολοκληρωμένα παιχνίδια",fr:"Jeux terminés",hi:"समाप्त हो गया खेल",es:"Juegos terminados"},MAIN_MATCH_GROUP_OPPONENT_TURN_MATCHES:{en:"Opponent turn",iw:"תור היריב",pt:"",zh:"对方回合",el:"",fr:"",hi:"",es:"Turno del oponente"},MAIN_MATCH_GROUP_YOUR_TURN_MATCHES:{en:"Your turn",iw:"תורך",pt:"",zh:"你的回合",el:"",fr:"",hi:"",es:"Tu turno"},MAIN_MATCH_LAST_MOVE_ON:{en:"Last move:",iw:"מסע אחרון:",pt:"Última jogada",zh:"最后一步",el:"Τελευταία κίνηση:",fr:"Dernier coup",hi:"पिछले कदम :",es:"Ultima jugada:"},MAIN_MATCH_STARTED_ON:{en:"Started:",iw:"המשחק התחיל:",pt:"Começo",zh:"开始",el:"Ξεκίνησε:",fr:"A débuté",hi:"आरंभ:",es:"Empezo:"},MAIN_NEW_AUTO_MATCH_EXPLANATION:{en:"Let us find an opponent for you automatically.",iw:"שחק נגד יריב אקראי",pt:"Jogar contra um oponente escolhido ao acaso",zh:"随机选择对手",el:"Παίξτε εναντίον τυχαίων αντιπάλων.",fr:"Jouer contre des adversaires choisis au hasard",hi:"बेतरतीब ढंग से चुनी प्रतिद्वंद्वी के खिलाफ खेलते हैं।",es:"Encontrar un oponente automaticamente"},MAIN_NEW_AUTO_MATCH_TITLE:{en:"Random opponent",iw:"יריב אקראי",pt:"Novo jogo contra um oponente escolhido ao acaso",zh:"自动找对手的新一局",el:"Νέο παιχνίδι εναντίον τυχαίου αντιπάλου",fr:"Nouveau jeu auto- adversaire",hi:"नई ऑटो - प्रतिद्वंद्वी खेल",es:"Oponente aleatorio"},MAIN_NEW_MATCH_GROUP_TITLE:{en:"New game",iw:"משחק חדש",pt:"Novo jogo",zh:"新一局",el:"Νέο παιχνίδι",fr:"Nouveau jeu",hi:"नया खेल",es:"Nuevo juego"},MAIN_PASS_AND_PLAY_EXPLANATION:{en:"Players will use the same phone/tablet.",iw:"כמה שחקנים ישחקו עם אותו טלפון",pt:"Todos os jogadores vão jogar no mesmo telefone/tablet.",zh:"在一台机器上玩",el:"Πολλαπλοί παίχτες στην ίδια συσκευή.",fr:"Plusieurs joueurs joueront sur le même portable/ tablette",hi:"कई खिलाड़ियों के एक ही फोन / टेबलेट पर खेलेंगे।",es:"Los jugadores usaran el mismo telefono/tablet"},MAIN_PASS_AND_PLAY_TITLE:{en:"Play together on one device",iw:"שחקו ביחד על מכשיר אחד",pt:"Mais de um jogador no mesmo telefone",zh:"在一台机器上玩",el:"Παίξτε μαζί στην ίδια συσκευή.",fr:"Jouer ensemble sur un seul appareil",hi:"एक डिवाइस पर एक साथ खेलते हैं",es:"Jugar contos en un dispositivo"},MAIN_PRACTICE_EXPLANATION:{en:"Play against the computer.",iw:"שחק נגד המחשב",pt:"Jogar contra o computador",zh:"和电脑玩",el:"Παίξτε εναντίον του υπολογιστή.",fr:"Jouer contre l'ordinateur",hi:"कंप्यूटर के खिलाफ खेलते हैं।",es:"Jugar contra la computadora"},MAIN_PRACTICE_TITLE:{en:"Practice",iw:"התאמן",pt:"Praticar",zh:"练习",el:"Εξάσκηση.",fr:"Entrainez",hi:"अभ्यास",es:"Practicar"},MAIN_SHARE_INVITE_LINK_TITLE:{en:"Share an invite link with your friends",iw:"שתף הזמנה למשחק עם חבריך",pt:"",zh:"分享链接给你的好友",el:"",fr:"",hi:"",es:"Compartir un link de invitacion con tus amigos."},MATCH_ALSO_DELETE:{en:"Also delete game",iw:"גם מחק את המשחק",pt:"",zh:"并且删除当前游戏",el:"",fr:"",hi:"",es:"Tambien borrar juego"},MATCH_DELETE:{en:"Delete game",iw:"מחק את המשחק",pt:"",zh:"删除当前游戏",el:"",fr:"",hi:"",es:"Borrar juego"},MATCH_LOAD_NEXT:{en:"Load next game",iw:"טען את המשחק הבא",pt:"",zh:"载入下场游戏",el:"",fr:"",hi:"",es:"Cargar siguiente juego"},MATCH_NEW_GAME:{en:"New game",iw:"משחק חדש",pt:"",zh:"新游戏",el:"",fr:"",hi:"",es:"Nueva partida"},MATCH_RESIGN_AND_DELETE:{en:"Resign and delete game",iw:"צא והפסד את המשחק",pt:"",zh:"重新分配并删除游戏",el:"",fr:"",hi:"",es:"Renunciar y borrar juego"},MATCH_SHARE_PRINTSCREEN:{en:"Share printscreen",iw:"שתף צילום מסך",pt:"",zh:"分享截屏",el:"",fr:"",hi:"",es:"Compartir pantalla"},MATCH_START_REMATCH:{en:"Rematch: start a new game with {{OPPONENTS_NAME}}",iw:"התחל משחק חדש עם {{OPPONENTS_NAME}",pt:"",zh:"新比赛：与{{OPPONENTS_NAME}}开始新游戏",el:"",fr:"",hi:"",es:"Revancha: nuevo juego con {{OPPONENTS_NAME}}"},MATCH_STATUS_CANCELED:{en:"Game canceled",iw:"משחק בוטל",pt:"Jogo cancelado",zh:"游戏取消",el:"Το παιχνίδι ακυρώθηκε",fr:"Jeu annulé",hi:"खेल रद्द",es:"Juego cancelado"},"MATCH_STATUS_COMPUTER'S_TURN":{en:"Computer's turn",iw:"תור המחשב",pt:"Turno do computador",zh:"该电脑下了",el:"Σειρά του υπολογιστή",fr:"Le tour de l'ordinateur",hi:"कंप्यूटर की बारी",es:"Turno de la computadoa"},MATCH_STATUS_COMPUTER_WON:{en:"Computer won",iw:"המחשב ניצח",pt:"O computador ganhou",zh:"电脑赢了",el:"Ο υπολογιστής κέρδισε",fr:"Computer a gagné",hi:"कम्प्यूटर जीता",es:"Computadora ganó"},MATCH_STATUS_ENDED_IN_TIE:{en:"Tie",iw:"תיקו",pt:"Empate",zh:"平局",el:"Ισοπαλία",fr:"Nul",hi:"खेल टाई",es:"Empate"},"MATCH_STATUS_OPPONENT'S_TURN":{en:"Opponent's turn",iw:"תור היריב",pt:"Vez do oponente",zh:"对方回合",el:"Σειρά του αντιπάλου",fr:"Le tour de l'adversaire",hi:"प्रतिद्वंद्वी की बारी",es:"Turno del oponente"},"MATCH_STATUS_OPPONENT'S_TURN_WITH_NAME":{en:"{{OPPONENT_NAME}}'s turn",iw:"תור {{OPPONENT_NAME}}",pt:"Vez do(a) {{OPPONENT_NAME}}",zh:"{{OPPONENT_NAME}}回合",el:"Σειρά του/της {{OPPONENT_NAME}}",fr:"Le tour de {OPPONENT_NAME}}",hi:"{{OPPONENT_NAME}} की बारी",es:"Turno de {{OPPONENT_NAME}}"},MATCH_STATUS_OPPONENT_WON:{en:"Opponent won",iw:"היריב נצח",pt:"O seu oponente ganhou",zh:"对方赢了",el:"Ο αντίπαλος κέρδισε",fr:"L'adversaire gagne",hi:"प्रतिद्वंद्वी जीता",es:"Oponente ganó"},MATCH_STATUS_OPPONENT_WON_WITH_NAME:{en:"{{OPPONENT_NAME}} won",iw:"{{OPPONENT_NAME}} נצח",pt:"{{OPPONENT_NAME}} ganhou",zh:"{OPPONENT_NAME}}贏了",el:"Ο/Η {{OPPONENT_NAME}} κέρδισε",fr:"{{OPPONENT_NAME}}  gagne",hi:"{{OPPONENT_NAME}} जीता",es:"{{OPPONENT_NAME}} ganó"},MATCH_STATUS_PASS_AND_PLAY_PLAYER_NUM_WON:{en:"Player {{PLAYER_NUMBER}} won",iw:"שחקן  {{PLAYER_NUMBER}} נצח",pt:"Jogador(a) {{PLAYER_NUMBER}} ganhou",zh:"{{PLAYER_NUMBER}}赢了",el:"Ο παίχτης με αριθμό Player {{PLAYER_NUMBER}} κέρδισε",fr:"Joueur {{PLAYER_NUMBER}} gagne",hi:"प्लेयर {{PLAYER_NUMBER}} जीता",es:"Player {{PLAYER_NUMBER}} ganó"},MATCH_STATUS_PASS_AND_PLAY_TURN_OF_PLAYER_NUM:{en:"Turn of player {{PLAYER_NUMBER}}",iw:"תור שחקן {{PLAYER_NUMBER}}",pt:"Vez do(a) jogador(a) {{PLAYER_NUMBER}}",zh:"{{PLAYER_NUMBER}}回合",el:"Σειρά του παίχτη {{PLAYER_NUMBER}}",fr:"Le tour de joueur {{PLAYER_NUMBER}}",hi:"खिलाड़ी {{PLAYER_NUMBER}} की बारी",es:"Turno de jugador no. {{PLAYER_NUMBER}}"},MATCH_STATUS_YOUR_TURN:{en:"Your turn",iw:"תורך",pt:"Sua vez",zh:"该你下了",el:"Είναι η σειρά σας",fr:"Votre tour",hi:"आपकी बारी",es:"Tu turno"},MATCH_STATUS_YOU_WON:{en:"You won!",iw:"נצחת!",pt:"Você ganhou!",zh:"你赢了",el:"Είστε ο νικητής!",fr:"Vous gagné!",hi:"आप जीते!",es:"Ganaste!"},MODAL_BUTTON_BLOCK:{en:"Block player from sending chats or invites",iw:"חסום את השחקן",pt:"",zh:"阻止用户发送消息或邀请",el:"",fr:"",hi:"",es:"Bloquear jugador de mandar invitaciones o chats"},MODAL_BUTTON_CLOSE:{en:"Close",iw:"סגור",pt:"Fechar",zh:"关闭",el:"Κλείσιμο",fr:"Fermez",hi:"बंद करे",es:"Cerrar"},MODAL_BUTTON_INVITE_TO_NEW_MATCH:{en:"New game",iw:"משחק חדש",pt:"",zh:"新游戏",el:"",fr:"",hi:"",es:"Juego nuevo"},MODAL_BUTTON_SAVE:{en:"Save",iw:"שמור",pt:"Salvar",zh:"保存",el:"Αποθήκευση",fr:"Sauvegarder",hi:"सहेजें",es:"Salvar"},MODAL_BUTTON_SEND_CHAT:{en:"Send",iw:"שלח",pt:"",zh:"发送",el:"",fr:"",hi:"",es:"Mandar"},MODAL_BUTTON_SEND_FEEDBACK_AND_BUGS:{en:"Send feedback",iw:"משוב",pt:"Enviar comentário",zh:"发送反馈",el:"Στείλτε την άποψη σας",fr:"Envoyez vos remarques",hi:"प्रतिक्रिया भेजें",es:"Mandar feedback"},MODAL_BUTTON_UNBLOCK:{en:"Unblock player: allow chats or invites",iw:"בטל חסימה",pt:"",zh:"解除阻止：允许发送消息或邀请",el:"",fr:"",hi:"",es:"Desbloquear jugador: permitir chats e invitaciones"},MODAL_FEEDBACK_AND_BUGS_PLACEHOLDER_TEXT:{en:"Enter your feedback here, and add your email if you want a reply :)",iw:"משוב",pt:"Entre aqui o seu comentário e o seu email se você quiser que nós lhe respondemos",zh:"在这里输入你的反馈，如果你想要收到回复那么请填写你的电子邮件",el:"Εισάγεται την άποψη σας εδώ και άμα περιμένετε κάποιου είδους απάντηση εισάγεται την ηλεκτρονική σαςδιεύθυνση",fr:"Entrez vos commentaires ici , et d'ajouter votre e-mail si vous souhaitez une réponse :)",hi:"यहाँ अपनी प्रतिक्रिया दर्ज करें, और आप एक जवाब चाहते हैं, तो आपके ईमेल जोड़ने :)",es:"Escribe tu feedback aqui, incluye tu e-mail si quieres una respuesta :)"},MODAL_TITLE_FEEDBACK_AND_BUGS:{en:"Feedback",iw:"משוב",pt:"Comentários",zh:"反馈",el:"Απόψεις και σφάλματα.",fr:"Commentaire",hi:"प्रतिक्रिया",es:"Feedback"},MODAL_TITLE_MATCH_OVER:{en:"Game over",iw:"משחק נגמר",pt:"Fim do jogo",zh:"游戏结束",el:"Λήξη παιχνιδιού",fr:"Jeu terminé",hi:"खेल खत्म",es:"Juego terminado"},MODAL_TITLE_USER_INFO:{en:"Your user info",iw:"פרטי משתמש",pt:"Suas Informações",zh:"你的用户信息",el:"Πληροφορίες χρήστη",fr:"Vos informations de l'utilisateur",hi:"आपका उपयोगकर्ता की जानकारी",es:"Tu informacion de perfil"},MODAL_USER_INFO_NAME:{en:"Name",iw:"שם",pt:"Nome",zh:"名称",el:"Όνομα",fr:"Nom",hi:"नाम",es:"Nombre"},MODAL_USER_INFO_USERNAME:{en:"User name",iw:"שם משתמש",pt:"Nome de usuário",zh:"用户名称",el:"",fr:"Le nom d'utilisateur",hi:"उपयोगकर्ता नाम",es:"Nombre de usuario"},MODAL_USER_INFO_USERNAME_WAS_TAKEN:{en:"This user name was already selected by someone else. Please choose another user name.",
iw:"שם משתמש הזה כבר נבחר על ידי מישהו אחר. בחר שם משתמש אחר בבקשה",pt:"Esse nome de usuário já foi escolhido por uma outra pessoa. Por favor, escolha um novo nome de usuário.",zh:"这个用户已经被其他用户选择了。请选择另一个用户",el:"",fr:"Ce nom d'utilisateur a déjà été sélectionné par quelqu'un d'autre . S'il vous plaît choisir un autre nom d'utilisateur.",hi:"यह उपयोगकर्ता नाम पहले से ही किसी और के द्वारा चुना गया था। एक अन्य उपयोगकर्ता के नाम का चयन करें।",es:"Este nombre de usuario no esta disponible. Por favor escoge otro nombre."},PUSH_NOTIFICATION_CHAT_MESSAGE_NOTIFICATION_TITLE:{en:"Message from {{OPPONENT_NAME}}:",iw:"הודעה מ {{OPPONENTS_NAME}",pt:"",zh:"来自{{OPPONENT_NAME}}的消息",el:"",fr:"",hi:"",es:"Mensaje de {{OPPONENT_NAME}}:"},PUSH_NOTIFICATION_MATCH_ENDED_TIE_NOTIFICATION_BODY:{en:"Game with {{OPPONENT_NAME}} ended in a tie",iw:"{{OPPONENT_NAME}} עשה מסע אחרון",pt:"Jogo contra {{OPPONENT_NAME}} terminou em empate",zh:"与{{OPPONENT_NAME}}的一局以平局结束",el:"Ο χρήστης  {{OPPONENT_NAME}} έκανε την τελευταία κίνηση",fr:"Jeu avec {{OPPONENT_NAME}} terminé par un match nul",hi:"{{OPPONENT_NAME}} के साथ खेल एक टाई में समाप्त हो गया",es:"Juego con {{OPPONENT_NAME}} termino empatado"},PUSH_NOTIFICATION_MATCH_ENDED_TIE_NOTIFICATION_TITLE:{en:"Game ended in a tie",iw:"משחק נגמר בתיקו",pt:"Jogo terminou em empate",zh:"平局",el:"Το παιχνίδι έληξε σε ισοπαλία",fr:"Jeu terminé en égalité",hi:"खेल एक टाई में समाप्त हो गया",es:"Juego termino empatado"},PUSH_NOTIFICATION_MATCH_ENDED_YOU_LOST_NOTIFICATION_BODY:{en:"{{OPPONENT_NAME}} won",iw:"{{OPPONENT_NAME}} נצח",pt:"{{OPPONENT_NAME}} ganhou",zh:"{{OPPONENT_NAME}}贏了",el:"Ο/Η 	{{OPPONENT_NAME}} κέρδισε",fr:"{{OPPONENT_NAME}} gagné",hi:"{{ OPPONENT_NAME }} जीता",es:"{{OPPONENT_NAME}} ganó"},PUSH_NOTIFICATION_MATCH_ENDED_YOU_LOST_NOTIFICATION_TITLE:{en:"You lost",iw:"הפסדת",pt:"Você perdeu",zh:"你输了",el:"Χάσατε",fr:"Vous perdu",hi:"आप हार गए",es:"Perdiste"},PUSH_NOTIFICATION_MATCH_ENDED_YOU_WON_NOTIFICATION_BODY:{en:"You won against {{OPPONENT_NAME}}!",iw:"{{OPPONENT_NAME}} הפסיד",pt:"Você ganhou contra {{OPPONENT_NAME}}!",zh:"你贏了{{OPPONENT_NAME}}!",el:"Ο/Η 	{{OPPONENT_NAME}} έχασε",fr:"Vous avez gagné contre {{OPPONENT_NAME}} !",hi:"आप {{OPPONENT_NAME}} के खिलाफ जीता  !",es:"Ganaste contra {{OPPONENT_NAME}}!"},PUSH_NOTIFICATION_MATCH_ENDED_YOU_WON_NOTIFICATION_TITLE:{en:"You won",iw:"נצחת",pt:"Você ganhou",zh:"你赢了",el:"Είστε ο νικητής",fr:"Vous gagné",hi:"आप जीते",es:"Ganaste"},PUSH_NOTIFICATION_NEW_MATCH_NOTIFICATION_BODY:{en:"{{OPPONENT_NAME}} invited you to play",iw:"{{OPPONENT_NAME}} הזמין אותך למשחק",pt:"{{OPPONENT_NAME}} te convidou para jogar",zh:"{{OPPONENT_NAME}}邀請你来玩",el:"Ο/Η 	{{OPPONENT_NAME}} σας προσκάλεσε να παίξετε",fr:"{{OPPONENT_NAME}} vous invité à jouer",hi:"{{OPPONENT_NAME}} खेलने के लिए आपको आमंत्रित किया",es:"{{OPPONENT_NAME}} te invito a jugar"},PUSH_NOTIFICATION_NEW_MATCH_NOTIFICATION_TITLE:{en:"New game",iw:"משחק חדש",pt:"Novo Jogo",zh:"新一局",el:"Νέο παιχνίδι",fr:"Nouveau jeu",hi:"नया खेल",es:"Nuevo juego"},PUSH_NOTIFICATION_OPPONENT_QUIT_NOTIFICATION_BODY:{en:"{{OPPONENT_NAME}} quit",iw:"{{OPPONENT_NAME}} עזב",pt:"{{OPPONENT_NAME}} saiu da partida",zh:"{{OPPONENT_NAME}}退出了",el:"Ο/Η 	{{OPPONENT_NAME}} παραιτήθηκε",fr:"{{OPPONENT_NAME}} quitter",hi:"{{OPPONENT_NAME}} छोड़ने",es:"{{OPPONENT_NAME}} renunció"},PUSH_NOTIFICATION_OPPONENT_QUIT_NOTIFICATION_TITLE:{en:"You won",iw:"נצחת",pt:"Você ganhou",zh:"你赢了",el:"Είστε ο νικητής",fr:"Vous gagné",hi:"आप जीते",es:"Ganaste"},PUSH_NOTIFICATION_YOUR_TURN_NOTIFICATION_BODY:{en:"{{OPPONENT_NAME}} just played",iw:"{{OPPONENT_NAME}} שחק",pt:"{{OPPONENT_NAME}} acabou de jogar",zh:"{{OPPONENT_NAME}}刚刚下了一步",el:"Ο/Η 	{{OPPONENT_NAME}} εκτέλεσε μια κίνηση",fr:"{{OPPONENT_NAME}} vient de jouer",hi:"{{OPPONENT_NAME}}  हाल ही में खेला",es:"{{OPPONENT_NAME}} hizo una jugada"},PUSH_NOTIFICATION_YOUR_TURN_NOTIFICATION_TITLE:{en:"Your turn",iw:"תורך",pt:"Sua vez",zh:"该你下了",el:"Είναι η σειρά σας",fr:"Votre tour",hi:"आपकी बारी",es:"Tu turno"},SHARE_INTENT_GAME_INVITE_MESSAGE:{en:"I want to play {{GAME_NAME}} with you!",iw:"אני רוצה לשחק {{GAME_NAME}} איתך!",pt:"Eu quero jogar {{GAME_NAME}} com você!",zh:"我想和你一起玩{{GAME_NAME}}!!",el:"",fr:"Je veux jouer {{GAME_NAME}} avec vous!",hi:"मैं तुम्हारे साथ {{GAME_NAME}} खेलना चाहता हूँ!",es:"Quiero jugar {{GAME_NAME}} contigo!"},SHARE_INTENT_GAME_INVITE_SUBJECT:{en:"Invitation to play {{GAME_NAME}}!",iw:"הזמנה למשחק {{GAME_NAME}}!",pt:"Convite para jogar {{GAME_NAME}}!",zh:"邀請你来玩{{GAME_NAME}}!!",el:"",fr:"Invitation à jouer {{GAME_NAME}} !",hi:"निमंत्रण {{GAME_NAME}} खेलने के लिए !",es:"Invitacion para jugar {{GAME_NAME}}!"},SHARE_INTENT_WON_GAME_MESSAGE:{en:"I won a game of {{GAME_NAME}}! Let's see if you can win against me!",iw:"נצחתי במשחק {{GAME_NAME}}! בוא נראה אם אתה יכול לנצח אותי!",pt:"Eu ganhei uma partida de {{GAME_NAME}}! Vamos ver se você consegue ganhar contra mim",zh:"我贏了一局{{GAME_NAME}}! 你赢得了我吗?",el:"",fr:"Je gagné un jeu de {{GAME_NAME}} ! Voyons voir si vous pouvez gagner contre moi !",hi:"मैं {{GAME_NAME}} का एक खेल जीता ! तुम मेरे खिलाफ जीत सकते हैं तो चलो देखते हैं !",es:"Gane un juego de {{GAME_NAME}}! Vamos a ver si puedes ganar contra mi!"},SHARE_INTENT_WON_GAME_SUBJECT:{en:"I won a game of {{GAME_NAME}}!",iw:"נצחתי במשחק {{GAME_NAME}}!",pt:"Eu ganhei uma partida de {{GAME_NAME}}!",zh:"我贏了一局{{GAME_NAME}}!",el:"",fr:"Je gagné un jeu de {{GAME_NAME}} !",hi:"मैं {{GAME_NAME}} का एक खेल जीता !",es:"Gane un partido de {{GAME_NAME}}!"},SHARE_INTENT_WON_GAME_TAKE_SCREENSHOT:{en:"Share a screenshot of your victory",iw:"שתף צילום מסך של הנצחון שלך",pt:"Compartilhe a imagem da sua vitória",zh:"分享你的胜利画面",el:"",fr:"Partager une capture d'écran de votre victoire",hi:"अपनी जीत के एक स्क्रीनशॉट साझा करें",es:"Comparte la pantalla de tu victoria"},SHARE_INTENT_WON_GAME_TAKE_SCREENSHOT_MAY_TAKE_TIME:{en:"Taking a screenshot may take a couple of seconds",iw:"צילום מסך יכול לקחת כמה שניות",pt:"Tirar a foto da sua tela pode demorar alguns segundos",zh:"屏幕截图也许需要几秒钟",el:"",fr:"Prendre une capture d'écran peut prendre quelques secondes",hi:"एक स्क्रीनशॉट लेने में कुछ सेकंड लग सकते हैं",es:"Tomar la captura de pantalla puede tomar unos momentos."},TO_MAIN_MENU:{en:"Go to main menu",iw:"חזור לתפריט הראשי",pt:"",zh:"前往主菜单",el:"",fr:"",hi:"",es:"Ir a menu principal"},UNKNOWN_PLAYER_NAME:{en:"Unknown",iw:"מישהו",pt:"Desconhecido",zh:"未知",el:"Άγνωστο",fr:"Inconnu",hi:"अज्ञात",es:"Desconocido"}};gamingPlatform.main.l10n().setTranslations(a)}();var gamingPlatform;!function(a){var b;!function(b){function c(){if(g()?a.log.info("In default theme, so this code is normally included, and not injected"):(j("Not in default theme, so adding window.onerror and gotMessage"),r.onerror=function(){k({hadPhonegapError:arguments})},r.gotMessage=d),!r.cordova)return void i("Phonegap didn't find cordova, so this is not inside phonegap.");r.PushNotification||(i('Phonegap did not find PushNotification plugin! Add to your config.xml this plugin: <gap:plugin name="phonegap-plugin-push" source="npm" version="1.2.3" />'),r.PushNotification={init:function(){return{on:function(){}}}}),r.facebookConnectPlugin||(i('Phonegap did not find facebookConnectPlugin! Did you add to your config.xml this plugin: <gap:plugin name="com.phonegap.plugins.facebookconnect" ...'),r.facebookConnectPlugin={browserInit:function(){},login:function(){},getLoginStatus:function(){},logout:function(){},showDialog:function(){}}),p=r.facebookConnectPlugin,q="android"==r.cordova.platformId||"Android"==r.cordova.platformId||"amazon-fireos"==r.cordova.platformId,i("isAndroid=",q," Phonegap platformId=",r.cordova.platformId),document.addEventListener("resume",function(){k({phonegapResumed:!0})});var b=r.PushNotification.init({android:{senderID:"24803504516",clearNotifications:!1},ios:{alert:!0,badge:!0,sound:!0,clearBadge:!0},windows:{}});b.on("registration",m),b.on("notification",n),b.on("error",o)}function d(a){if(r.cordova){i("Phonegap start handling message: ",a);var b=a.appId;switch(a.type){case 1:var c=a.permissions;l(b),p.login(c,h,h);break;case 0:l(b),p.getLoginStatus(h,h);break;case 2:l(b),p.logout(h,h);break;case 3:s.app?s.app.exitApp():s.device&&s.device.exitApp();break;case 4:e(a.shareOptions)}i("Phonegap finished handling message: ",a)}}function e(a){a.takePrintscreen?s.screenshot&&s.screenshot.URI?s.screenshot.URI(function(b,c){if(i("navigator.screenshot.URI error=",b," res=",c&&c.URI?c.URI.substring(0,100):c),b||!c||!c.URI)return void f(a);var d=c.URI;a.image=d,f(a)}):(i('Missing screenshot plugin! You need to add to your config.xml: <gap:plugin name="it.zerob.cordova.screenshot" source="pgb" version="0.1.3" />'),f(a)):f(a)}function f(a){return r.plugins&&r.plugins.socialsharing&&r.plugins.socialsharing.share?void(a.toEmail?r.plugins.socialsharing.shareViaEmail(a.message,a.subject,[a.toEmail],null,null,null,function(){},function(){}):r.plugins.socialsharing.share(a.message,a.subject,a.image,a.link)):void i('Missing socialsharing plugin! You need to add to your config.xml: <gap:plugin name="nl.x-services.plugins.socialsharing" />')}function g(){return a.urlParams&&a.urlParams.phonegapPlugins}function h(a){k({fbLoginStatus:a})}function i(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];return g()?void a.log.info(b):void k({addLog:b})}function j(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];console&&console.log&&console.log(a)}function k(b){if(j("Phonegap sends message:",b),g())return void a.$timeout(function(){return a.phoneGapService.onMessageRecieve(b)},0);var c=document.getElementById("platform_iframe");c?c.contentWindow.postMessage(b,"*"):j("Not in phonegap or platform_iframe is undefined.")}function l(a){t||(t=!0,"browser"==r.cordova.platformId&&(j("fbBrowserInit with appId="+a),p.browserInit(a)))}function m(a){var b=q?"ANDROID":"IOS",c=a.registrationId;j(["PushNotification registration:",a,"device token = ",c," platformType=",b]);var d={registrationId:c,platformType:b};k({registerForPushNotifications:d})}function n(a){i("PushNotification notification:",a),a.additionalData&&k({gotPushNotification:{matchInfoJson:a.additionalData.matchInfoJson,gotChatJson:a.additionalData.gotChatJson,coldstart:a.additionalData.coldstart,foreground:a.additionalData.foreground,matchId:a.additionalData.matchId,updatedTimestampMillis:a.additionalData.updatedTimestampMillis}})}function o(a){i("PushNotification error:",a)}var p,q,r=window,s=window.navigator;c(),b.gotMessage=d;var t=!1}(b=a.phonegapCode||(a.phonegapCode={}))}(gamingPlatform||(gamingPlatform={}));
//# sourceMappingURL=everything.min.js.map